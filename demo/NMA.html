<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snazzy Inari: Synaptic Symphony - Advanced Neural Analysis Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/marked@4.0.2/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@2.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.144.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.6.1/dist/d3.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        secondary: '#6c757d',
                        success: '#28a745',
                        danger: '#dc3545',
                        warning: '#ffc107',
                        info: '#17a2b8',
                        light: '#f8f9fa',
                        dark: '#181818',
                        neural: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e'
                        },
                        synapse: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75'
                        },
                        brain: {
                            cortex: '#ff6b6b',
                            hippocampus: '#4ecdc4',
                            striatum: '#45b7d1',
                            thalamus: '#f7b733',
                            cerebellum: '#5f27cd',
                            midbrain: '#00d2d3',
                            pons: '#ff9ff3',
                            medulla: '#54a0ff'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                        display: ['Poppins', 'sans-serif']
                    },
                    animation: {
                        'spin-slow': 'spin 3s linear infinite',
                        'pulse-fast': 'pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-soft': 'bounce 2s infinite',
                        'neural-pulse': 'neural-pulse 2s ease-in-out infinite',
                        'wave': 'wave 3s ease-in-out infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'slide-up': 'slide-up 0.5s ease-out',
                        'fade-in': 'fade-in 0.3s ease-in'
                    },
                    boxShadow: {
                        'neural': '0 0 20px rgba(14, 165, 233, 0.3)',
                        'synapse': '0 0 20px rgba(217, 70, 239, 0.3)',
                        'brain': '0 0 30px rgba(93, 92, 222, 0.4)',
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.37)',
                        'inner-lg': 'inset 0 2px 4px 0 rgba(0, 0, 0, 0.1)'
                    },
                    backdropBlur: {
                        'xs': '2px'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');
        
        * {
            scroll-behavior: smooth;
        }
        
        body {
            font-synthesis: none;
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .loader {
            border-top-color: #5D5CDE;
            animation: spinner 0.6s linear infinite;
        }
        
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes neural-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }
        
        @keyframes wave {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(1deg); }
            66% { transform: translateY(5px) rotate(-1deg); }
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(93, 92, 222, 0.4); }
            to { box-shadow: 0 0 20px rgba(93, 92, 222, 0.8); }
        }
        
        @keyframes slide-up {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .dark .dark\:bg-dark {
            background-color: #181818;
        }
        
        .blur-effect {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .dark .glass-effect {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .transition-all {
            transition-property: all;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 300ms;
        }
        
        .shadow-custom {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .dark .shadow-custom {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
        }
        
        .code-editor {
            font-family: 'Fira Code', monospace;
            line-height: 1.5;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #0ea5e9 0%, #d946ef 50%, #5D5CDE 100%);
        }
        
        .neural-gradient {
            background: linear-gradient(135deg, #0369a1 0%, #a21caf 30%, #5D5CDE 60%, #c026d3 100%);
        }
        
        .brain-gradient {
            background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 25%, #45b7d1 50%, #f7b733 75%, #5f27cd 100%);
        }
        
        .chart-container {
            position: relative;
            height: 350px;
            width: 100%;
        }
        
        .large-chart-container {
            position: relative;
            height: 500px;
            width: 100%;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
        }
        
        .neural-indicator {
            position: relative;
            overflow: hidden;
        }
        
        .neural-indicator::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #0ea5e9, #d946ef, #5D5CDE, #c026d3);
            animation: wave 2s ease-in-out infinite;
        }
        
        .data-card {
            transform: translateY(0);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .data-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        
        .neural-network {
            background: radial-gradient(circle at 50% 50%, rgba(14, 165, 233, 0.1) 0%, transparent 50%);
            position: relative;
            overflow: hidden;
        }
        
        .synapse-node {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: linear-gradient(45deg, #d946ef, #c026d3);
            position: absolute;
            animation: neural-pulse 3s ease-in-out infinite;
            box-shadow: 0 0 10px rgba(217, 70, 239, 0.5);
        }
        
        .brain-heatmap {
            display: grid;
            grid-template-columns: repeat(25, 1fr);
            gap: 1px;
            padding: 8px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.05);
        }
        
        .heatmap-cell {
            width: 8px;
            height: 8px;
            border-radius: 1px;
            background: #e2e8f0;
            transition: all 0.2s ease;
        }
        
        .heatmap-cell:hover {
            transform: scale(1.5);
            z-index: 10;
        }
        
        .heatmap-cell.activity-1 { background: linear-gradient(45deg, #bfdbfe, #93c5fd); }
        .heatmap-cell.activity-2 { background: linear-gradient(45deg, #93c5fd, #60a5fa); }
        .heatmap-cell.activity-3 { background: linear-gradient(45deg, #60a5fa, #3b82f6); }
        .heatmap-cell.activity-4 { background: linear-gradient(45deg, #3b82f6, #2563eb); }
        .heatmap-cell.activity-5 { background: linear-gradient(45deg, #2563eb, #1d4ed8); }
        
        .dark .heatmap-cell {
            background: #1e293b;
        }
        
        .dark .heatmap-cell.activity-1 { background: linear-gradient(45deg, #334155, #475569); }
        .dark .heatmap-cell.activity-2 { background: linear-gradient(45deg, #475569, #64748b); }
        .dark .heatmap-cell.activity-3 { background: linear-gradient(45deg, #64748b, #94a3b8); }
        .dark .heatmap-cell.activity-4 { background: linear-gradient(45deg, #94a3b8, #cbd5e1); }
        .dark .heatmap-cell.activity-5 { background: linear-gradient(45deg, #cbd5e1, #e2e8f0); }
        
        .pulse-ring {
            animation: pulse-ring 1.25s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        
        @keyframes pulse-ring {
            0% {
                transform: scale(0.33);
            }
            40%, 50% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: scale(1.2);
            }
        }
        
        .brain-region {
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 8px;
            padding: 4px;
        }
        
        .brain-region:hover {
            transform: scale(1.15);
            filter: brightness(1.3) saturate(1.2);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
        }
        
        .brain-svg {
            max-width: 100%;
            height: auto;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }
        
        .region-visual-cortex { fill: #ff6b6b; }
        .region-motor-cortex { fill: #4ecdc4; }
        .region-auditory-cortex { fill: #45b7d1; }
        .region-somatosensory { fill: #f7b733; }
        .region-prefrontal { fill: #5f27cd; }
        .region-hippocampus { fill: #00d2d3; }
        .region-striatum { fill: #ff9ff3; }
        .region-thalamus { fill: #54a0ff; }
        .region-cerebellum { fill: #5f27cd; }
        .region-brainstem { fill: #ff7675; }
        .region-olfactory { fill: #00b894; }
        .region-amygdala { fill: #fdcb6e; }
        
        .region-visual-cortex:hover { fill: #ff5252; }
        .region-motor-cortex:hover { fill: #26d0ce; }
        .region-auditory-cortex:hover { fill: #2196f3; }
        .region-somatosensory:hover { fill: #ffc107; }
        .region-prefrontal:hover { fill: #673ab7; }
        .region-hippocampus:hover { fill: #00acc1; }
        .region-striatum:hover { fill: #e91e63; }
        .region-thalamus:hover { fill: #2196f3; }
        .region-cerebellum:hover { fill: #9c27b0; }
        .region-brainstem:hover { fill: #f44336; }
        .region-olfactory:hover { fill: #4caf50; }
        .region-amygdala:hover { fill: #ff9800; }
        
        .neuron-spike {
            width: 6px;
            height: 6px;
            background: radial-gradient(circle, #00ff88, #0066ff);
            border-radius: 50%;
            position: absolute;
            animation: spike-travel 2s linear infinite;
        }
        
        @keyframes spike-travel {
            0% { opacity: 0; transform: scale(0); }
            10% { opacity: 1; transform: scale(1); }
            90% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0); }
        }
        
        .connection-line {
            stroke: rgba(14, 165, 233, 0.6);
            stroke-width: 2;
            stroke-dasharray: 5,5;
            animation: dash 2s linear infinite;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: -10;
            }
        }
        
        .electrode-site {
            fill: #ffd700;
            stroke: #ff6b00;
            stroke-width: 2;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .electrode-site:hover {
            fill: #ffed4e;
            stroke: #ff8c00;
            stroke-width: 3;
            transform: scale(1.2);
        }
        
        .firing-rate-indicator {
            width: 4px;
            height: 20px;
            background: linear-gradient(to top, #00ff00, #ffff00, #ff0000);
            border-radius: 2px;
            margin: 0 1px;
            animation: firing-pulse 1s ease-in-out infinite;
        }
        
        @keyframes firing-pulse {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }
        
        .network-graph {
            width: 100%;
            height: 400px;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.05) 0%, rgba(217, 70, 239, 0.05) 100%);
        }
        
        .statistics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .dark .stat-card {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.35s;
        }
        
        .brain-waves {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .wave-line {
            stroke: rgba(14, 165, 233, 0.4);
            stroke-width: 2;
            fill: none;
            animation: wave-flow 3s ease-in-out infinite;
        }
        
        @keyframes wave-flow {
            0%, 100% { stroke-dashoffset: 0; }
            50% { stroke-dashoffset: 20; }
        }
        
        .neuron-cluster {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 10px;
        }
        
        .neuron-body {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #ffffff, #0ea5e9);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px rgba(14, 165, 233, 0.5);
            animation: float 4s ease-in-out infinite;
        }
        
        .dendrite {
            position: absolute;
            background: linear-gradient(45deg, #0ea5e9, #d946ef);
            border-radius: 2px;
            animation: dendrite-pulse 2s ease-in-out infinite;
        }
        
        @keyframes dendrite-pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        .synapse-animation {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, #ffffff, #d946ef);
            border-radius: 50%;
            animation: synapse-fire 1.5s ease-in-out infinite;
        }
        
        @keyframes synapse-fire {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.5); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        .brain-activity-meter {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #ff0000, #ffff00, #00ff00, #0000ff, #ff0000);
            position: relative;
            animation: rotate 10s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .brain-activity-meter::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            background: white;
            border-radius: 50%;
        }
        
        .activity-needle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 2px;
            height: 80px;
            background: #333;
            transform-origin: bottom center;
            transform: translate(-50%, -100%) rotate(45deg);
            animation: needle-sweep 3s ease-in-out infinite;
        }
        
        @keyframes needle-sweep {
            0%, 100% { transform: translate(-50%, -100%) rotate(0deg); }
            25% { transform: translate(-50%, -100%) rotate(90deg); }
            50% { transform: translate(-50%, -100%) rotate(180deg); }
            75% { transform: translate(-50%, -100%) rotate(270deg); }
        }
        
        .matrix-rain {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        
        .matrix-char {
            position: absolute;
            color: #0ea5e9;
            font-family: 'Fira Code', monospace;
            font-size: 12px;
            animation: matrix-fall 3s linear infinite;
        }
        
        @keyframes matrix-fall {
            0% { transform: translateY(-100px); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(500px); opacity: 0; }
        }
        
        .eeg-wave {
            stroke: #0ea5e9;
            stroke-width: 2;
            fill: none;
            animation: eeg-flow 2s ease-in-out infinite;
        }
        
        @keyframes eeg-flow {
            0%, 100% { stroke-dashoffset: 0; }
            50% { stroke-dashoffset: 10; }
        }
        
        .neural-connection {
            stroke: rgba(217, 70, 239, 0.6);
            stroke-width: 1;
            stroke-dasharray: 2,2;
            animation: connection-pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes connection-pulse {
            0%, 100% { opacity: 0.3; stroke-width: 1; }
            50% { opacity: 1; stroke-width: 2; }
        }
        
        .brain-slice {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .brain-slice:hover {
            filter: brightness(1.2) saturate(1.3);
            transform: scale(1.05);
        }
        
        .recording-electrode {
            fill: #ffd700;
            stroke: #ff6b00;
            stroke-width: 1;
            animation: electrode-blink 2s ease-in-out infinite;
        }
        
        @keyframes electrode-blink {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        .signal-trace {
            stroke: #00ff88;
            stroke-width: 1;
            fill: none;
            animation: trace-flow 1s linear infinite;
        }
        
        @keyframes trace-flow {
            0% { stroke-dashoffset: 0; }
            100% { stroke-dashoffset: 10; }
        }
        
        .popup-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .popup-tooltip.show {
            opacity: 1;
        }
        
        .analysis-panel {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
        }
        
        .dark .analysis-panel {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0.1) 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .metric-display {
            font-family: 'Fira Code', monospace;
            font-weight: 600;
            font-size: 1.5rem;
            background: linear-gradient(45deg, #0ea5e9, #d946ef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .data-visualization {
            border: 2px solid transparent;
            background: linear-gradient(white, white) padding-box, 
                        linear-gradient(45deg, #0ea5e9, #d946ef) border-box;
            border-radius: 12px;
        }
        
        .dark .data-visualization {
            background: linear-gradient(#1f2937, #1f2937) padding-box, 
                        linear-gradient(45deg, #0ea5e9, #d946ef) border-box;
        }
        
        .interactive-element {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .interactive-element:hover {
            transform: scale(1.02);
            filter: brightness(1.1);
        }
        
        .interactive-element:active {
            transform: scale(0.98);
        }
        
        .loading-animation {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(93, 92, 222, 0.3);
            border-radius: 50%;
            border-top-color: #5D5CDE;
            animation: spin 1s ease-in-out infinite;
        }
        
        .neural-oscillation {
            stroke: #0ea5e9;
            stroke-width: 2;
            fill: none;
            animation: oscillate 3s ease-in-out infinite;
        }
        
        @keyframes oscillate {
            0%, 100% { stroke-dasharray: 5, 5; stroke-dashoffset: 0; }
            50% { stroke-dasharray: 5, 5; stroke-dashoffset: 10; }
        }
        
        .brain-region-label {
            font-size: 10px;
            font-weight: 600;
            fill: #ffffff;
            text-anchor: middle;
            dominant-baseline: central;
            pointer-events: none;
        }
        
        .activity-heatmap {
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }
        
        .activity-heatmap:hover {
            opacity: 1;
        }
        
        .responsive-container {
            width: 100%;
            max-width: none;
            margin: 0 auto;
        }
        
        @media (max-width: 768px) {
            .chart-container {
                height: 250px;
            }
            
            .large-chart-container {
                height: 350px;
            }
            
            .brain-heatmap {
                grid-template-columns: repeat(15, 1fr);
            }
            
            .heatmap-cell {
                width: 6px;
                height: 6px;
            }
            
            .neuron-cluster {
                width: 80px;
                height: 80px;
            }
            
            .neuron-body {
                width: 48px;
                height: 48px;
            }
        }
        
        @media (max-width: 640px) {
            .statistics-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 200px;
            }
            
            .large-chart-container {
                height: 300px;
            }
        }
    </style>
</head>
<body class="font-sans bg-gray-50 dark:bg-dark text-gray-900 dark:text-gray-100 transition-all">
    <div class="min-h-screen flex flex-col">
        <header class="sticky top-0 z-30 bg-white/80 dark:bg-gray-900/80 backdrop-blur-md shadow-lg border-b border-gray-200 dark:border-gray-700">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div class="h-12 w-12 neural-gradient rounded-xl flex items-center justify-center shadow-neural">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-neural-600 via-synapse-600 to-primary bg-clip-text text-transparent">Snazzy Inari</h1>
                        <p class="text-sm text-gray-500 dark:text-gray-400 font-medium">Advanced Neural Analysis Platform</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <div id="system-status" class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse shadow-lg"></div>
                        <span class="text-sm text-gray-600 dark:text-gray-400 font-medium">IBL Connected</span>
                        <div class="h-6 w-px bg-gray-300 dark:bg-gray-600"></div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">
                            <div>CPU: <span class="text-green-500 font-semibold">94%</span></div>
                            <div>MEM: <span class="text-blue-500 font-semibold">67%</span></div>
                        </div>
                    </div>
                    <button id="darkModeToggle" class="p-3 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-all group">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden dark:block group-hover:scale-110 transition-transform">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="block dark:hidden group-hover:scale-110 transition-transform">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <main class="flex-grow overflow-x-hidden">
            <div id="auth-screen" class="flex flex-col items-center justify-center min-h-[90vh] px-4 gradient-bg relative overflow-hidden">
                <div class="matrix-rain" id="matrix-rain"></div>
                <div class="max-w-lg w-full bg-white/10 dark:bg-gray-800/20 rounded-2xl shadow-brain p-8 glass-effect backdrop-blur-xl border border-white/20">
                    <div class="text-center mb-8">
                        <div class="h-20 w-20 neural-gradient rounded-2xl flex items-center justify-center mx-auto mb-6 pulse-ring shadow-neural">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="white">
                                <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.96-9.08A2.5 2.5 0 0 1 9.5 2Z"></path>
                                <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.96-9.08A2.5 2.5 0 0 0 14.5 2Z"></path>
                            </svg>
                        </div>
                        <h2 class="text-4xl font-bold text-white mb-2">Snazzy Inari</h2>
                        <p class="text-white/80 text-lg font-medium">Advanced Synaptic Symphony Platform</p>
                        <p class="text-white/60 text-sm mt-2">Modulation of Neural Activity by Prior Expectations</p>
                        <p class="text-white/50 text-xs mt-1">International Brain Laboratory Dataset Analysis</p>
                    </div>
                    <form id="auth-form" class="space-y-6">
                        <div class="space-y-2">
                            <label for="username" class="block text-sm font-semibold text-white/90">Researcher Identification</label>
                            <input type="text" id="username" name="username" required class="w-full px-4 py-4 bg-white/10 border border-white/20 rounded-xl focus:outline-none focus:ring-2 focus:ring-neural-400 focus:border-transparent text-base text-white placeholder-white/50 backdrop-blur-sm" placeholder="Enter your researcher ID">
                        </div>
                        <div class="space-y-2">
                            <label for="token" class="block text-sm font-semibold text-white/90">IBL Access Token</label>
                            <input type="password" id="token" name="token" required class="w-full px-4 py-4 bg-white/10 border border-white/20 rounded-xl focus:outline-none focus:ring-2 focus:ring-synapse-400 focus:border-transparent text-base text-white placeholder-white/50 backdrop-blur-sm" placeholder="International Brain Laboratory access token">
                            <p class="text-xs text-white/60 mt-2">Authorized researchers only - IBL dataset access required</p>
                        </div>
                        <button type="submit" class="w-full neural-gradient hover:opacity-90 text-white font-semibold py-4 px-6 rounded-xl transition-all flex justify-center items-center shadow-neural group">
                            <span class="group-hover:scale-105 transition-transform">Access Neural Analytics</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-3 group-hover:translate-x-1 transition-transform">
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                                <polyline points="12 5 19 12 12 19"></polyline>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>

            <div id="dashboard" class="hidden">
                <div class="container mx-auto px-4 py-8">
                    <div class="mb-8 flex flex-col lg:flex-row lg:items-center lg:justify-between">
                        <div class="mb-6 lg:mb-0">
                            <h2 class="text-3xl md:text-4xl font-bold flex items-center mb-2">
                                Advanced Neural Analysis Dashboard
                                <span class="ml-4 inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-green-400 to-green-600 text-white shadow-lg">
                                    <div class="w-2 h-2 bg-white rounded-full mr-2 animate-pulse"></div>
                                    Live Analysis
                                </span>
                            </h2>
                            <p class="text-gray-600 dark:text-gray-400 text-lg mb-3">Real-time analysis of neural activity modulation by prior expectations</p>
                            <div class="flex flex-wrap items-center gap-4 text-sm">
                                <span class="flex items-center text-gray-500 dark:text-gray-400">
                                    <div class="w-2 h-2 bg-neural-500 rounded-full mr-2"></div>
                                    Research Team: <span class="text-neural-600 font-semibold ml-1">Synaptic Symphony Consortium</span>
                                </span>
                                <span class="text-gray-400">•</span>
                                <span class="flex items-center text-gray-500 dark:text-gray-400">
                                    <div class="w-2 h-2 bg-synapse-500 rounded-full mr-2"></div>
                                    Dataset: <span class="text-synapse-600 font-semibold ml-1">IBL Brain-Wide Neural Activity</span>
                                </span>
                                <span class="text-gray-400">•</span>
                                <span class="flex items-center text-gray-500 dark:text-gray-400">
                                    <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                                    Status: <span class="text-green-600 font-semibold ml-1">Active Processing</span>
                                </span>
                                <span class="text-gray-400">•</span>
                                <span class="flex items-center text-gray-500 dark:text-gray-400">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full mr-2"></div>
                                    Sessions: <span class="text-blue-600 font-semibold ml-1">156 Complete</span>
                                </span>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-3">
                            <button id="export-data-btn" class="flex items-center bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-5 rounded-xl transition-all shadow-lg hover:shadow-xl group">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 group-hover:scale-110 transition-transform">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                Export Analysis
                            </button>
                            <button id="refresh-btn" class="flex items-center bg-gradient-to-r from-neural-500 to-neural-600 hover:from-neural-600 hover:to-neural-700 text-white font-semibold py-3 px-5 rounded-xl transition-all shadow-lg hover:shadow-xl group">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 group-hover:rotate-180 transition-transform duration-500">
                                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"></path>
                                </svg>
                                Refresh Data
                            </button>
                            <button id="analysis-btn" class="flex items-center bg-gradient-to-r from-synapse-500 to-synapse-600 hover:from-synapse-600 hover:to-synapse-700 text-white font-semibold py-3 px-5 rounded-xl transition-all shadow-lg hover:shadow-xl group">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 group-hover:scale-110 transition-transform">
                                    <path d="M3 3v18h18"></path>
                                    <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"></path>
                                </svg>
                                Run Advanced Analysis
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 xl:grid-cols-8 gap-4 mb-8">
                        <div class="data-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-neural-500 analysis-panel">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-xs font-semibold uppercase tracking-wide">Total Neurons</p>
                                    <p id="total-neurons" class="metric-display">2,847</p>
                                    <p id="neurons-change" class="text-xs text-neural-500 font-medium">+247 analyzed</p>
                                </div>
                                <div class="h-12 w-12 bg-neural-100 dark:bg-neural-900/30 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-neural-600">
                                        <circle cx="12" cy="12" r="3"></circle>
                                        <path d="M12 1v6m0 6v6"></path>
                                        <path d="M1 12h6m6 0h6"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="data-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-synapse-500 analysis-panel">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-xs font-semibold uppercase tracking-wide">Brain Regions</p>
                                    <p id="brain-regions" class="metric-display">18</p>
                                    <p id="regions-percentage" class="text-xs text-synapse-500 font-medium">Multi-area coverage</p>
                                </div>
                                <div class="h-12 w-12 bg-synapse-100 dark:bg-synapse-900/30 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-synapse-600">
                                        <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.96-9.08A2.5 2.5 0 0 1 9.5 2Z"></path>
                                        <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.96-9.08A2.5 2.5 0 0 0 14.5 2Z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="data-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-green-500 analysis-panel">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-xs font-semibold uppercase tracking-wide">Prior Effect</p>
                                    <p id="prior-effect" class="metric-display">73.2%</p>
                                    <p id="effect-confidence" class="text-xs text-green-500 font-medium">Highly Significant</p>
                                </div>
                                <div class="h-12 w-12 bg-green-100 dark:bg-green-900/30 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-600">
                                        <path d="M3 3v18h18"></path>
                                        <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="data-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-purple-500 analysis-panel">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-xs font-semibold uppercase tracking-wide">Total Trials</p>
                                    <p id="total-trials" class="metric-display">8,456</p>
                                    <p id="trials-avg" class="text-xs text-purple-500 font-medium">IBL Standard</p>
                                </div>
                                <div class="h-12 w-12 bg-purple-100 dark:bg-purple-900/30 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-purple-600">
                                        <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="data-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-blue-500 analysis-panel">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-xs font-semibold uppercase tracking-wide">Model Accuracy</p>
                                    <p id="model-accuracy" class="metric-display">96.8%</p>
                                    <p id="accuracy-trend" class="text-xs text-blue-500 font-medium">Excellent Performance</p>
                                </div>
                                <div class="h-12 w-12 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600">
                                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="data-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-indigo-500 analysis-panel">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-xs font-semibold uppercase tracking-wide">PCA Variance</p>
                                    <p id="pca-variance" class="metric-display">84.7%</p>
                                    <p id="pca-components" class="text-xs text-indigo-500 font-medium">5 Components</p>
                                </div>
                                <div class="h-12 w-12 bg-indigo-100 dark:bg-indigo-900/30 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-600">
                                        <rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect>
                                        <circle cx="9" cy="9" r="2"></circle>
                                        <path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="data-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-red-500 analysis-panel">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-xs font-semibold uppercase tracking-wide">Effect Size</p>
                                    <p id="effect-size" class="metric-display">0.73</p>
                                    <p id="effect-magnitude" class="text-xs text-red-500 font-medium">Large Effect</p>
                                </div>
                                <div class="h-12 w-12 bg-red-100 dark:bg-red-900/30 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-red-600">
                                        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="data-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-yellow-500 analysis-panel">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-xs font-semibold uppercase tracking-wide">Significance</p>
                                    <p id="significance-level" class="metric-display">p&lt;0.001</p>
                                    <p id="statistical-power" class="text-xs text-yellow-500 font-medium">Power: 0.98</p>
                                </div>
                                <div class="h-12 w-12 bg-yellow-100 dark:bg-yellow-900/30 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-yellow-600">
                                        <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                                        <line x1="3" y1="6" x2="21" y2="6"></line>
                                        <path d="M16 10a4 4 0 0 1-8 0"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8">
                        <div class="lg:col-span-3">
                            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 analysis-panel">
                                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                                    <div>
                                        <h3 class="text-xl font-bold mb-2">Population Neural Activity Dynamics</h3>
                                        <p class="text-gray-600 dark:text-gray-400 text-sm">Real-time firing rate patterns across experimental conditions</p>
                                    </div>
                                    <div class="flex items-center space-x-3 mt-4 sm:mt-0">
                                        <select id="time-window-select" class="px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-neural-500">
                                            <option value="stimulus">Stimulus Period</option>
                                            <option value="decision">Decision Period</option>
                                            <option value="feedback">Feedback Period</option>
                                            <option value="full">Full Trial</option>
                                        </select>
                                        <button id="play-animation" class="flex items-center px-3 py-2 bg-neural-500 text-white rounded-lg hover:bg-neural-600 transition-all">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="large-chart-container">
                                    <canvas id="neuralActivityChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-6">
                            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 analysis-panel">
                                <h3 class="text-lg font-semibold mb-4">Regional Distribution</h3>
                                <div class="chart-container">
                                    <canvas id="brainRegionChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden mb-8 analysis-panel">
                        <div class="flex border-b border-gray-200 dark:border-gray-700 overflow-x-auto scrollbar-thin">
                            <button id="tab-neural" class="tab-btn px-8 py-5 text-sm font-semibold border-b-3 border-neural-500 text-neural-600 bg-neural-500/10 dark:bg-neural-500/20 flex-shrink-0 transition-all">
                                <div class="flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="3"></circle>
                                        <path d="M12 1v6m0 6v6"></path>
                                        <path d="M1 12h6m6 0h6"></path>
                                    </svg>
                                    <span>Neural Data Analysis</span>
                                </div>
                            </button>
                            <button id="tab-behavioral" class="tab-btn px-8 py-5 text-sm font-semibold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 border-b-3 border-transparent hover:border-gray-300 dark:hover:border-gray-700 flex-shrink-0 transition-all">
                                <div class="flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                                    </svg>
                                    <span>Behavioral Patterns</span>
                                </div>
                            </button>
                            <button id="tab-population" class="tab-btn px-8 py-5 text-sm font-semibold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 border-b-3 border-transparent hover:border-gray-300 dark:hover:border-gray-700 flex-shrink-0 transition-all">
                                <div class="flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect>
                                        <circle cx="9" cy="9" r="2"></circle>
                                        <path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path>
                                    </svg>
                                    <span>Population Dynamics</span>
                                </div>
                            </button>
                            <button id="tab-single-unit" class="tab-btn px-8 py-5 text-sm font-semibold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 border-b-3 border-transparent hover:border-gray-300 dark:hover:border-gray-700 flex-shrink-0 transition-all">
                                <div class="flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M3 3v18h18"></path>
                                        <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"></path>
                                    </svg>
                                    <span>Single-Unit Analysis</span>
                                </div>
                            </button>
                            <button id="tab-brain-map" class="tab-btn px-8 py-5 text-sm font-semibold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 border-b-3 border-transparent hover:border-gray-300 dark:hover:border-gray-700 flex-shrink-0 transition-all">
                                <div class="flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.96-9.08A2.5 2.5 0 0 1 9.5 2Z"></path>
                                        <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.96-9.08A2.5 2.5 0 0 0 14.5 2Z"></path>
                                    </svg>
                                    <span>Brain Mapping</span>
                                </div>
                            </button>
                            <button id="tab-connectivity" class="tab-btn px-8 py-5 text-sm font-semibold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 border-b-3 border-transparent hover:border-gray-300 dark:hover:border-gray-700 flex-shrink-0 transition-all">
                                <div class="flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="m6 6 12 12"></path>
                                        <path d="m6 18 12-12"></path>
                                        <path d="M12 12h.01"></path>
                                    </svg>
                                    <span>Connectivity Analysis</span>
                                </div>
                            </button>
                            <button id="tab-results" class="tab-btn px-8 py-5 text-sm font-semibold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 border-b-3 border-transparent hover:border-gray-300 dark:hover:border-gray-700 flex-shrink-0 transition-all">
                                <div class="flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                                        <line x1="3" y1="6" x2="21" y2="6"></line>
                                        <path d="M16 10a4 4 0 0 1-8 0"></path>
                                    </svg>
                                    <span>Research Findings</span>
                                </div>
                            </button>
                        </div>

                        <div id="content-neural" class="tab-content p-8">
                            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8">
                                <div class="mb-6 lg:mb-0">
                                    <h3 class="text-2xl font-bold mb-2">Comprehensive Neural Data Analysis</h3>
                                    <p class="text-gray-500 dark:text-gray-400">Real-time processing and analysis of IBL neural recordings across multiple brain regions</p>
                                </div>
                                <div class="flex flex-col sm:flex-row gap-4">
                                    <select id="brain-region-filter" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-neural-500 focus:border-transparent text-base">
                                        <option value="all">All Brain Regions</option>
                                        <option value="visual">Visual Areas (VISp, VISl, VISal, VISpm, VISam)</option>
                                        <option value="motor">Motor Areas (MOp, MOs, SSp, SSs)</option>
                                        <option value="frontal">Frontal Areas (ACAd, ACAv, PL, ILA, ORBl, ORBm, ORBvl)</option>
                                        <option value="hippocampal">Hippocampal Areas (CA1, CA2, CA3, DG)</option>
                                        <option value="thalamic">Thalamic Areas (VPM, VPL, POm, LGd, LGv)</option>
                                        <option value="striatal">Striatal Areas (CP, ACB, OT)</option>
                                    </select>
                                    <select id="prior-condition" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-synapse-500 focus:border-transparent text-base">
                                        <option value="both">Both Prior Conditions</option>
                                        <option value="left">Left Prior Block</option>
                                        <option value="right">Right Prior Block</option>
                                        <option value="contrast">Prior Contrast Analysis</option>
                                        <option value="transition">Block Transition Effects</option>
                                    </select>
                                    <select id="analysis-method" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-base">
                                        <option value="firing-rate">Firing Rate Analysis</option>
                                        <option value="spike-correlation">Spike Train Correlation</option>
                                        <option value="lfp-analysis">LFP Power Spectrum</option>
                                        <option value="coherence">Cross-Regional Coherence</option>
                                    </select>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                <div class="lg:col-span-2 space-y-8">
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                        <h4 class="text-xl font-bold mb-6">Real-Time Neural Activity Patterns</h4>
                                        <div class="neural-network rounded-xl p-8 relative" style="height: 400px;">
                                            <div class="absolute inset-0 flex items-center justify-center">
                                                <div class="text-center">
                                                    <div class="w-24 h-24 neural-gradient rounded-2xl flex items-center justify-center mx-auto mb-6 animate-float shadow-neural">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="white">
                                                            <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                                                        </svg>
                                                    </div>
                                                    <p class="text-neural-600 dark:text-neural-400 text-2xl font-bold mb-2">Neural Activity Monitoring</p>
                                                    <p class="text-gray-500 text-lg">Real-time spike train analysis</p>
                                                    <div class="flex justify-center space-x-4 mt-6">
                                                        <div class="firing-rate-indicator"></div>
                                                        <div class="firing-rate-indicator" style="animation-delay: 0.1s;"></div>
                                                        <div class="firing-rate-indicator" style="animation-delay: 0.2s;"></div>
                                                        <div class="firing-rate-indicator" style="animation-delay: 0.3s;"></div>
                                                        <div class="firing-rate-indicator" style="animation-delay: 0.4s;"></div>
                                                        <div class="firing-rate-indicator" style="animation-delay: 0.5s;"></div>
                                                        <div class="firing-rate-indicator" style="animation-delay: 0.6s;"></div>
                                                        <div class="firing-rate-indicator" style="animation-delay: 0.7s;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="synapse-node" style="top: 10%; left: 15%; animation-delay: 0s;"></div>
                                            <div class="synapse-node" style="top: 25%; left: 75%; animation-delay: 0.5s;"></div>
                                            <div class="synapse-node" style="top: 45%; left: 35%; animation-delay: 1s;"></div>
                                            <div class="synapse-node" style="top: 15%; left: 60%; animation-delay: 1.5s;"></div>
                                            <div class="synapse-node" style="top: 65%; left: 80%; animation-delay: 2s;"></div>
                                            <div class="synapse-node" style="top: 80%; left: 25%; animation-delay: 2.5s;"></div>
                                            <div class="synapse-node" style="top: 70%; left: 55%; animation-delay: 3s;"></div>
                                            <div class="synapse-node" style="top: 30%; left: 85%; animation-delay: 3.5s;"></div>
                                            <div class="synapse-node" style="top: 85%; left: 10%; animation-delay: 4s;"></div>
                                            <div class="synapse-node" style="top: 55%; left: 65%; animation-delay: 4.5s;"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                        <h4 class="text-xl font-bold mb-6">Neural Response Characteristics</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl">
                                                <h5 class="text-lg font-semibold mb-4">Spike Raster Plot</h5>
                                                <div class="w-full h-48 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center relative overflow-hidden">
                                                    <div class="text-center">
                                                        <div class="w-12 h-12 bg-neural-500 rounded-xl mx-auto mb-3 animate-pulse flex items-center justify-center">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white">
                                                                <path d="M3 3v18h18"></path>
                                                                <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"></path>
                                                            </svg>
                                                        </div>
                                                        <p class="text-sm text-gray-500">Individual Neuron Spikes</p>
                                                    </div>
                                                    <div id="spike-dots" class="absolute inset-0">
                                                    </div>
                                                </div>
                                                <div class="mt-4 flex justify-between text-sm">
                                                    <span>Prior Effect: <strong class="text-neural-600">p = 0.0023</strong></span>
                                                    <span>Modulation: <strong class="text-synapse-600">31.4%</strong></span>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl">
                                                <h5 class="text-lg font-semibold mb-4">PSTH Analysis</h5>
                                                <div class="w-full h-48 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center">
                                                    <canvas id="psthChart" width="300" height="180"></canvas>
                                                </div>
                                                <div class="mt-4 flex justify-between text-sm">
                                                    <span>Peak Latency: <strong class="text-green-600">127ms</strong></span>
                                                    <span>Response Duration: <strong class="text-blue-600">245ms</strong></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="space-y-6">
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-6">Real-Time Activity Feed</h4>
                                        <div class="space-y-4 max-h-80 overflow-y-auto scrollbar-thin" id="activity-feed">
                                            <div class="flex items-center space-x-3 p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm">
                                                <div class="w-3 h-3 bg-neural-500 rounded-full animate-pulse"></div>
                                                <div class="flex-1">
                                                    <p class="text-sm font-semibold">VISp Prior Encoding Detected</p>
                                                    <p class="text-xs text-gray-500">Visual cortex shows strong modulation - 2s ago</p>
                                                </div>
                                                <span class="text-xs px-2 py-1 bg-neural-100 text-neural-800 rounded-full font-medium">HIGH</span>
                                            </div>
                                            <div class="flex items-center space-x-3 p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm">
                                                <div class="w-3 h-3 bg-synapse-500 rounded-full animate-pulse"></div>
                                                <div class="flex-1">
                                                    <p class="text-sm font-semibold">MOp Motor Preparation</p>
                                                    <p class="text-xs text-gray-500">Motor cortex activity detected - 5s ago</p>
                                                </div>
                                                <span class="text-xs px-2 py-1 bg-synapse-100 text-synapse-800 rounded-full font-medium">MOD</span>
                                            </div>
                                            <div class="flex items-center space-x-3 p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm">
                                                <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                                                <div class="flex-1">
                                                    <p class="text-sm font-semibold">ACAd Population Dynamics</p>
                                                    <p class="text-xs text-gray-500">Anterior cingulate trajectory shift - 8s ago</p>
                                                </div>
                                                <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full font-medium">NEW</span>
                                            </div>
                                            <div class="flex items-center space-x-3 p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm">
                                                <div class="w-3 h-3 bg-blue-500 rounded-full animate-pulse"></div>
                                                <div class="flex-1">
                                                    <p class="text-sm font-semibold">LGd Thalamic Response</p>
                                                    <p class="text-xs text-gray-500">Lateral geniculate activity - 12s ago</p>
                                                </div>
                                                <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full font-medium">SIG</span>
                                            </div>
                                            <div class="flex items-center space-x-3 p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm">
                                                <div class="w-3 h-3 bg-purple-500 rounded-full animate-pulse"></div>
                                                <div class="flex-1">
                                                    <p class="text-sm font-semibold">SSp Sensory Integration</p>
                                                    <p class="text-xs text-gray-500">Somatosensory processing - 15s ago</p>
                                                </div>
                                                <span class="text-xs px-2 py-1 bg-purple-100 text-purple-800 rounded-full font-medium">LOW</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-6">Processing Status</h4>
                                        <div class="space-y-4">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Neural Data Processing</span>
                                                <div class="flex items-center space-x-2">
                                                    <div class="loading-animation"></div>
                                                    <span class="text-neural-600 text-sm font-semibold">Running</span>
                                                </div>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-neural-600 h-2 rounded-full animate-pulse" style="width: 87%"></div>
                                            </div>
                                            
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Prior Analysis</span>
                                                <span class="text-green-600 text-sm font-semibold">Complete</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-green-600 h-2 rounded-full" style="width: 100%"></div>
                                            </div>
                                            
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Population Analysis</span>
                                                <span class="text-yellow-600 text-sm font-semibold">Processing</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-yellow-600 h-2 rounded-full animate-pulse" style="width: 65%"></div>
                                            </div>
                                            
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Statistical Testing</span>
                                                <span class="text-blue-600 text-sm font-semibold">Queued</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-blue-600 h-2 rounded-full" style="width: 25%"></div>
                                            </div>
                                            
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">IBL Synchronization</span>
                                                <span class="text-green-600 text-sm font-semibold">Connected</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-green-600 h-2 rounded-full animate-pulse" style="width: 100%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-6">Analysis Parameters</h4>
                                        <div class="space-y-3">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm">Sampling Rate</span>
                                                <span class="font-semibold text-neural-600">30 kHz</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm">Spike Detection</span>
                                                <span class="font-semibold text-synapse-600">Threshold -4σ</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm">Bin Size</span>
                                                <span class="font-semibold text-green-600">10ms</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm">Window Length</span>
                                                <span class="font-semibold text-blue-600">500ms</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm">Smoothing Kernel</span>
                                                <span class="font-semibold text-purple-600">Gaussian 25ms</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm">Statistical Test</span>
                                                <span class="font-semibold text-indigo-600">Permutation</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="content-behavioral" class="tab-content hidden p-8">
                            <div class="mb-8">
                                <h3 class="text-2xl font-bold mb-2">Behavioral Data Analysis</h3>
                                <p class="text-gray-500 dark:text-gray-400">Comprehensive analysis of psychometric curves, choice behavior, and learning dynamics</p>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Psychometric Curves</h4>
                                    <div class="chart-container">
                                        <canvas id="psychometricChart"></canvas>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Prior Block Effects</h4>
                                    <div class="space-y-6">
                                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl">
                                            <div class="flex justify-between items-center mb-3">
                                                <span class="text-sm font-semibold">Left Prior Bias Strength</span>
                                                <span class="text-neural-600 text-lg font-bold">72.8%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                                                <div class="bg-gradient-to-r from-neural-500 to-neural-600 h-3 rounded-full shadow-lg" style="width: 72.8%"></div>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-2">Significant bias toward left choices in left prior blocks</p>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl">
                                            <div class="flex justify-between items-center mb-3">
                                                <span class="text-sm font-semibold">Right Prior Bias Strength</span>
                                                <span class="text-synapse-600 text-lg font-bold">69.4%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                                                <div class="bg-gradient-to-r from-synapse-500 to-synapse-600 h-3 rounded-full shadow-lg" style="width: 69.4%"></div>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-2">Significant bias toward right choices in right prior blocks</p>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl">
                                            <div class="flex justify-between items-center mb-3">
                                                <span class="text-sm font-semibold">Zero Contrast Effect Size</span>
                                                <span class="text-green-600 text-lg font-bold">p &lt; 0.001</span>
                                            </div>
                                            <div class="flex items-center space-x-2">
                                                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                                <p class="text-sm text-gray-600 dark:text-gray-400">Highly significant bias at zero contrast conditions</p>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-2">Cohen's d = 0.87 (large effect size)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8">
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                    <h4 class="text-lg font-bold mb-4">Response Timing</h4>
                                    <div class="space-y-4">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Mean RT</span>
                                            <span class="text-lg font-bold text-neural-600">0.734s</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Median RT</span>
                                            <span class="text-lg font-bold text-synapse-600">0.681s</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Std Deviation</span>
                                            <span class="text-lg font-bold text-green-600">0.267s</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Fast Trials (&lt;500ms)</span>
                                            <span class="text-lg font-bold text-blue-600">18.3%</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Timeout Rate</span>
                                            <span class="text-lg font-bold text-red-600">2.8%</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                    <h4 class="text-lg font-bold mb-4">Block Structure</h4>
                                    <div class="space-y-4">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Total Blocks</span>
                                            <span class="text-lg font-bold text-neural-600">76</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Left Blocks</span>
                                            <span class="text-lg font-bold text-synapse-600">38</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Right Blocks</span>
                                            <span class="text-lg font-bold text-green-600">38</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Mean Block Length</span>
                                            <span class="text-lg font-bold text-blue-600">89 trials</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Block Transitions</span>
                                            <span class="text-lg font-bold text-purple-600">75</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                    <h4 class="text-lg font-bold mb-4">Performance Metrics</h4>
                                    <div class="space-y-4">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Overall Accuracy</span>
                                            <span class="text-lg font-bold text-green-600">86.7%</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Learning Rate (α)</span>
                                            <span class="text-lg font-bold text-neural-600">0.147</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Lapse Rate (λ)</span>
                                            <span class="text-lg font-bold text-yellow-600">3.2%</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Bias Strength (b)</span>
                                            <span class="text-lg font-bold text-synapse-600">0.341</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Sensitivity (d')</span>
                                            <span class="text-lg font-bold text-blue-600">2.134</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                    <h4 class="text-lg font-bold mb-4">Learning Dynamics</h4>
                                    <div class="space-y-4">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Block Adaptation</span>
                                            <span class="text-lg font-bold text-neural-600">15.3 trials</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Plateau Performance</span>
                                            <span class="text-lg font-bold text-green-600">91.2%</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Forgetting Rate</span>
                                            <span class="text-lg font-bold text-orange-600">0.023</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Win-Stay Rate</span>
                                            <span class="text-lg font-bold text-purple-600">88.4%</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm">Lose-Switch Rate</span>
                                            <span class="text-lg font-bold text-red-600">67.9%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Learning Curves Over Sessions</h4>
                                    <div class="chart-container">
                                        <canvas id="learningCurveChart"></canvas>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Reaction Time Distributions</h4>
                                    <div class="chart-container">
                                        <canvas id="reactionTimeChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="content-population" class="tab-content hidden p-8">
                            <div class="mb-8 flex flex-col lg:flex-row lg:items-center lg:justify-between">
                                <div class="mb-6 lg:mb-0">
                                    <h3 class="text-2xl font-bold mb-2">Population Dynamics Analysis</h3>
                                    <p class="text-gray-500 dark:text-gray-400">Advanced dimensionality reduction and population trajectory analysis across brain regions</p>
                                </div>
                                <div class="flex flex-col sm:flex-row gap-4">
                                    <select id="population-region" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-neural-500 focus:border-transparent text-base">
                                        <option value="all">All Brain Regions</option>
                                        <option value="visual">Visual Cortex Complex</option>
                                        <option value="motor">Motor Areas</option>
                                        <option value="frontal">Frontal Cortex</option>
                                        <option value="hippocampal">Hippocampal Formation</option>
                                        <option value="thalamic">Thalamic Nuclei</option>
                                    </select>
                                    <select id="analysis-type" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-synapse-500 focus:border-transparent text-base">
                                        <option value="pca">Principal Component Analysis</option>
                                        <option value="ica">Independent Component Analysis</option>
                                        <option value="umap">UMAP Embedding</option>
                                        <option value="tsne">t-SNE Visualization</option>
                                    </select>
                                    <button id="run-pca" class="px-6 py-3 neural-gradient text-white rounded-xl hover:opacity-90 transition-all shadow-lg font-semibold">
                                        Run Analysis
                                    </button>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                                <div class="lg:col-span-2 bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Population Trajectory Visualization</h4>
                                    <div class="w-full h-96 bg-white dark:bg-gray-800 rounded-xl flex items-center justify-center relative overflow-hidden">
                                        <div class="text-center">
                                            <div class="w-20 h-20 neural-gradient rounded-2xl flex items-center justify-center mx-auto mb-4 animate-float">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="white">
                                                    <rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect>
                                                    <circle cx="9" cy="9" r="2"></circle>
                                                    <path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path>
                                                </svg>
                                            </div>
                                            <p class="text-neural-600 dark:text-neural-400 text-xl font-bold mb-2">3D Trajectory Analysis</p>
                                            <p class="text-gray-500 text-lg">Principal Component Space Visualization</p>
                                        </div>
                                        <div id="trajectory-plot" class="absolute inset-0"></div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Explained Variance</h4>
                                    <div class="chart-container">
                                        <canvas id="varianceChart"></canvas>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8">
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                    <h4 class="text-lg font-bold mb-4">Component Analysis</h4>
                                    <div class="space-y-3">
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">PC1 Variance</span>
                                                <span class="text-neural-600 text-lg font-bold">47.3%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mt-2">
                                                <div class="bg-neural-600 h-2 rounded-full" style="width: 47.3%"></div>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">PC2 Variance</span>
                                                <span class="text-synapse-600 text-lg font-bold">26.8%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mt-2">
                                                <div class="bg-synapse-600 h-2 rounded-full" style="width: 26.8%"></div>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">PC3 Variance</span>
                                                <span class="text-green-600 text-lg font-bold">15.2%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mt-2">
                                                <div class="bg-green-600 h-2 rounded-full" style="width: 15.2%"></div>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Total Explained</span>
                                                <span class="text-purple-600 text-lg font-bold">89.3%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mt-2">
                                                <div class="bg-purple-600 h-2 rounded-full" style="width: 89.3%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                    <h4 class="text-lg font-bold mb-4">Trajectory Metrics</h4>
                                    <div class="space-y-3">
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Path Length</span>
                                                <span class="text-blue-600 text-lg font-bold">18.7 units</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Prior Separation</span>
                                                <span class="text-red-600 text-lg font-bold">Significant</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Effective Dims</span>
                                                <span class="text-indigo-600 text-lg font-bold">12.4</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Drift Rate</span>
                                                <span class="text-orange-600 text-lg font-bold">0.02/trial</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                    <h4 class="text-lg font-bold mb-4">Cross-Regional Correlations</h4>
                                    <div class="space-y-3">
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">VISp ↔ ACAd</span>
                                                <span class="text-green-600 text-lg font-bold">r = 0.73</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">MOp ↔ SSp</span>
                                                <span class="text-neural-600 text-lg font-bold">r = 0.61</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">LGd ↔ VISp</span>
                                                <span class="text-synapse-600 text-lg font-bold">r = 0.84</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">CA1 ↔ ACAd</span>
                                                <span class="text-purple-600 text-lg font-bold">r = 0.52</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                    <h4 class="text-lg font-bold mb-4">Clustering Analysis</h4>
                                    <div class="space-y-3">
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Cluster Count</span>
                                                <span class="text-blue-600 text-lg font-bold">7</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Silhouette Score</span>
                                                <span class="text-green-600 text-lg font-bold">0.67</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Davies-Bouldin</span>
                                                <span class="text-yellow-600 text-lg font-bold">0.43</span>
                                            </div>
                                        </div>
                                        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Inertia</span>
                                                <span class="text-red-600 text-lg font-bold">2847.3</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Temporal Evolution of Components</h4>
                                    <div class="chart-container">
                                        <canvas id="temporalComponentChart"></canvas>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Cross-Condition Distance Matrix</h4>
                                    <div class="w-full h-80 bg-white dark:bg-gray-800 rounded-xl flex items-center justify-center">
                                        <div id="distance-matrix" class="w-full h-full"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="content-single-unit" class="tab-content hidden p-8">
                            <div class="mb-8 flex flex-col lg:flex-row lg:items-center lg:justify-between">
                                <div class="mb-6 lg:mb-0">
                                    <h3 class="text-2xl font-bold mb-2">Single-Unit Neural Analysis</h3>
                                    <p class="text-gray-500 dark:text-gray-400">Individual neuron response patterns, encoding properties, and statistical characterization</p>
                                </div>
                                <div class="flex flex-col sm:flex-row gap-4">
                                    <select id="neuron-filter" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-neural-500 focus:border-transparent text-base">
                                        <option value="all">All Neurons (2,847)</option>
                                        <option value="significant">Significant Only (674)</option>
                                        <option value="modulated">Prior Modulated (521)</option>
                                        <option value="visual">Visual Responsive (1,234)</option>
                                        <option value="motor">Motor Related (567)</option>
                                        <option value="choice">Choice Predictive (389)</option>
                                    </select>
                                    <select id="sort-criteria" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-synapse-500 focus:border-transparent text-base">
                                        <option value="p-value">Sort by P-value</option>
                                        <option value="effect-size">Sort by Effect Size</option>
                                        <option value="firing-rate">Sort by Firing Rate</option>
                                        <option value="region">Sort by Brain Region</option>
                                    </select>
                                    <button id="analyze-units" class="px-6 py-3 neural-gradient text-white rounded-xl hover:opacity-90 transition-all shadow-lg font-semibold">
                                        Analyze Selected
                                    </button>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                                <div class="lg:col-span-4 space-y-8">
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                        <h4 class="text-xl font-bold mb-6">Featured Single Neuron Responses</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl border-l-4 border-neural-500">
                                                <div class="flex justify-between items-center mb-4">
                                                    <h5 class="text-lg font-semibold">Neuron #1247 (VISp)</h5>
                                                    <span class="px-3 py-1 bg-neural-100 text-neural-800 rounded-full text-sm font-medium">HIGH SIG</span>
                                                </div>
                                                <div class="w-full h-40 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center mb-4 relative overflow-hidden">
                                                    <canvas id="neuron1-raster" width="300" height="150"></canvas>
                                                </div>
                                                <div class="grid grid-cols-2 gap-4 text-sm">
                                                    <div>
                                                        <span class="text-gray-500">Prior Effect:</span>
                                                        <div class="font-bold text-neural-600">p = 0.0008</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Modulation:</span>
                                                        <div class="font-bold text-synapse-600">34.7%</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Firing Rate:</span>
                                                        <div class="font-bold text-green-600">18.3 Hz</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Quality:</span>
                                                        <div class="font-bold text-blue-600">9.2/10</div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl border-l-4 border-synapse-500">
                                                <div class="flex justify-between items-center mb-4">
                                                    <h5 class="text-lg font-semibold">Neuron #0847 (ACAd)</h5>
                                                    <span class="px-3 py-1 bg-synapse-100 text-synapse-800 rounded-full text-sm font-medium">MOD</span>
                                                </div>
                                                <div class="w-full h-40 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center mb-4">
                                                    <canvas id="neuron2-psth" width="300" height="150"></canvas>
                                                </div>
                                                <div class="grid grid-cols-2 gap-4 text-sm">
                                                    <div>
                                                        <span class="text-gray-500">Prior Effect:</span>
                                                        <div class="font-bold text-neural-600">p = 0.0156</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Modulation:</span>
                                                        <div class="font-bold text-synapse-600">21.3%</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Firing Rate:</span>
                                                        <div class="font-bold text-green-600">12.7 Hz</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Quality:</span>
                                                        <div class="font-bold text-blue-600">8.5/10</div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl border-l-4 border-green-500">
                                                <div class="flex justify-between items-center mb-4">
                                                    <h5 class="text-lg font-semibold">Neuron #1583 (MOp)</h5>
                                                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">MOTOR</span>
                                                </div>
                                                <div class="w-full h-40 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center mb-4">
                                                    <canvas id="neuron3-tuning" width="300" height="150"></canvas>
                                                </div>
                                                <div class="grid grid-cols-2 gap-4 text-sm">
                                                    <div>
                                                        <span class="text-gray-500">Prior Effect:</span>
                                                        <div class="font-bold text-neural-600">p = 0.0089</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Modulation:</span>
                                                        <div class="font-bold text-synapse-600">15.8%</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Firing Rate:</span>
                                                        <div class="font-bold text-green-600">25.4 Hz</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Quality:</span>
                                                        <div class="font-bold text-blue-600">7.8/10</div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl border-l-4 border-purple-500">
                                                <div class="flex justify-between items-center mb-4">
                                                    <h5 class="text-lg font-semibold">Neuron #2156 (CA1)</h5>
                                                    <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium">PLACE</span>
                                                </div>
                                                <div class="w-full h-40 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center mb-4">
                                                    <canvas id="neuron4-spatial" width="300" height="150"></canvas>
                                                </div>
                                                <div class="grid grid-cols-2 gap-4 text-sm">
                                                    <div>
                                                        <span class="text-gray-500">Prior Effect:</span>
                                                        <div class="font-bold text-neural-600">p = 0.0234</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Modulation:</span>
                                                        <div class="font-bold text-synapse-600">19.2%</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Firing Rate:</span>
                                                        <div class="font-bold text-green-600">8.9 Hz</div>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-500">Quality:</span>
                                                        <div class="font-bold text-blue-600">8.9/10</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                        <h4 class="text-xl font-bold mb-6">Population Summary Statistics</h4>
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                                <thead>
                                                    <tr class="bg-gray-100 dark:bg-gray-800">
                                                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Brain Region</th>
                                                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Total Neurons</th>
                                                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Significant</th>
                                                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Prior Modulated</th>
                                                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Mean Effect Size</th>
                                                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Firing Rate (Hz)</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold">VISp</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">387</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">89 (23.0%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">127 (32.8%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">0.24 ± 0.15</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">15.7 ± 8.3</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold">ACAd</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">234</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">67 (28.6%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">89 (38.0%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">0.31 ± 0.18</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">12.4 ± 6.7</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold">MOp</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">198</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">34 (17.2%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">45 (22.7%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">0.18 ± 0.12</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">18.9 ± 9.8</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold">SSp</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">156</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">23 (14.7%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">34 (21.8%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">0.16 ± 0.11</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">14.2 ± 7.5</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold">CA1</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">134</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">28 (20.9%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">39 (29.1%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">0.22 ± 0.14</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">9.6 ± 5.2</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold">LGd</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">89</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">19 (21.3%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">26 (29.2%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">0.27 ± 0.16</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">22.1 ± 12.4</td>
                                                    </tr>
                                                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold">Others</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">1,649</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">414 (25.1%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">361 (21.9%)</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">0.19 ± 0.13</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm">13.8 ± 8.1</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="space-y-6">
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Encoding Properties</h4>
                                        <div class="space-y-3 text-sm">
                                            <div class="flex justify-between items-center">
                                                <span class="text-gray-500">Visual Responsive</span>
                                                <span class="font-bold text-neural-600">72.4%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-neural-600 h-2 rounded-full" style="width: 72.4%"></div>
                                            </div>
                                            
                                            <div class="flex justify-between items-center">
                                                <span class="text-gray-500">Prior Encoding</span>
                                                <span class="font-bold text-synapse-600">28.3%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-synapse-600 h-2 rounded-full" style="width: 28.3%"></div>
                                            </div>
                                            
                                            <div class="flex justify-between items-center">
                                                <span class="text-gray-500">Choice Predictive</span>
                                                <span class="font-bold text-green-600">36.7%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-green-600 h-2 rounded-full" style="width: 36.7%"></div>
                                            </div>
                                            
                                            <div class="flex justify-between items-center">
                                                <span class="text-gray-500">Contrast Sensitive</span>
                                                <span class="font-bold text-blue-600">61.2%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-blue-600 h-2 rounded-full" style="width: 61.2%"></div>
                                            </div>
                                            
                                            <div class="flex justify-between items-center">
                                                <span class="text-gray-500">Motor Related</span>
                                                <span class="font-bold text-purple-600">19.9%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-purple-600 h-2 rounded-full" style="width: 19.9%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Temporal Dynamics</h4>
                                        <div class="space-y-3 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Peak Latency</span>
                                                <span class="font-bold">142ms ± 67ms</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Response Duration</span>
                                                <span class="font-bold">289ms ± 134ms</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Adaptation Rate</span>
                                                <span class="font-bold">0.31/s ± 0.18</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Burst Index</span>
                                                <span class="font-bold">1.67 ± 0.42</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">CV ISI</span>
                                                <span class="font-bold">0.89 ± 0.23</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Statistical Tests</h4>
                                        <div class="space-y-3 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">ANOVA F-statistic</span>
                                                <span class="font-bold">F = 18.73</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Overall p-value</span>
                                                <span class="font-bold text-green-600">p &lt; 0.001</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Effect Size (η²)</span>
                                                <span class="font-bold">0.23 ± 0.14</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Statistical Power</span>
                                                <span class="font-bold">0.96</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">FDR Correction</span>
                                                <span class="font-bold text-blue-600">Benjamini-Hochberg</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Quality Metrics</h4>
                                        <div class="space-y-3 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Signal-to-Noise</span>
                                                <span class="font-bold">8.4 ± 2.1</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Isolation Quality</span>
                                                <span class="font-bold text-green-600">Excellent</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Waveform Stability</span>
                                                <span class="font-bold">95.3%</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Contamination Rate</span>
                                                <span class="font-bold">1.2%</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Recording Duration</span>
                                                <span class="font-bold">67.4 min</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="content-brain-map" class="tab-content hidden p-8">
                            <div class="mb-8 flex flex-col lg:flex-row lg:items-center lg:justify-between">
                                <div class="mb-6 lg:mb-0">
                                    <h3 class="text-2xl font-bold mb-2">Advanced Brain-Wide Activity Mapping</h3>
                                    <p class="text-gray-500 dark:text-gray-400">Interactive 3D visualization of neural activity across anatomical regions with Allen Brain Atlas integration</p>
                                </div>
                                <div class="flex flex-col sm:flex-row gap-4">
                                    <select id="map-overlay" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-neural-500 focus:border-transparent text-base">
                                        <option value="activity">Neural Activity Level</option>
                                        <option value="prior">Prior Encoding Strength</option>
                                        <option value="contrast">Contrast Sensitivity</option>
                                        <option value="choice">Choice Predictive Power</option>
                                        <option value="firing-rate">Mean Firing Rate</option>
                                        <option value="significance">Statistical Significance</option>
                                    </select>
                                    <select id="slice-plane" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-synapse-500 focus:border-transparent text-base">
                                        <option value="coronal">Coronal Sections</option>
                                        <option value="sagittal">Sagittal Sections</option>
                                        <option value="horizontal">Horizontal Sections</option>
                                        <option value="3d">3D Volume Render</option>
                                    </select>
                                    <button id="update-map" class="px-6 py-3 neural-gradient text-white rounded-xl hover:opacity-90 transition-all shadow-lg font-semibold">
                                        Update Visualization
                                    </button>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                                <div class="lg:col-span-4">
                                    <div class="bg-gray-900 rounded-2xl overflow-hidden shadow-2xl" style="height: 600px;">
                                        <div class="w-full h-full flex items-center justify-center relative">
                                            <div class="text-center z-10">
                                                <div class="w-24 h-24 brain-gradient rounded-2xl flex items-center justify-center mx-auto mb-6 animate-float">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="white">
                                                        <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.96-9.08A2.5 2.5 0 0 1 9.5 2Z"></path>
                                        <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.96-9.08A2.5 2.5 0 0 0 14.5 2Z"></path>
                                                    </svg>
                                                </div>
                                                <p class="text-white text-2xl font-bold mb-3">Interactive Brain Atlas</p>
                                                <p class="text-gray-300 text-lg mb-6">Allen Brain Institute Reference</p>
                                                <div class="flex justify-center space-x-6 mb-8">
                                                    <div class="brain-region w-6 h-6 bg-gradient-to-r from-red-400 to-red-600 rounded-lg shadow-lg" title="Visual Cortex"></div>
                                                    <div class="brain-region w-6 h-6 bg-gradient-to-r from-teal-400 to-teal-600 rounded-lg shadow-lg" title="Motor Cortex"></div>
                                                    <div class="brain-region w-6 h-6 bg-gradient-to-r from-blue-400 to-blue-600 rounded-lg shadow-lg" title="Somatosensory"></div>
                                                    <div class="brain-region w-6 h-6 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-lg shadow-lg" title="Frontal Areas"></div>
                                                    <div class="brain-region w-6 h-6 bg-gradient-to-r from-purple-400 to-purple-600 rounded-lg shadow-lg" title="Hippocampus"></div>
                                                    <div class="brain-region w-6 h-6 bg-gradient-to-r from-cyan-400 to-cyan-600 rounded-lg shadow-lg" title="Thalamus"></div>
                                                </div>
                                            </div>
                                            <div id="brain-3d-container" class="absolute inset-0">
                                                <svg viewBox="0 0 800 600" class="w-full h-full brain-svg">
                                                    <defs>
                                                        <linearGradient id="cortexGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                                            <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
                                                            <stop offset="100%" style="stop-color:#ff5252;stop-opacity:1" />
                                                        </linearGradient>
                                                        <linearGradient id="hippoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                                            <stop offset="0%" style="stop-color:#4ecdc4;stop-opacity:1" />
                                                            <stop offset="100%" style="stop-color:#26d0ce;stop-opacity:1" />
                                                        </linearGradient>
                                                        <linearGradient id="motorGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                                            <stop offset="0%" style="stop-color:#45b7d1;stop-opacity:1" />
                                                            <stop offset="100%" style="stop-color:#2196f3;stop-opacity:1" />
                                                        </linearGradient>
                                                        <linearGradient id="thalamusGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                                            <stop offset="0%" style="stop-color:#f7b733;stop-opacity:1" />
                                                            <stop offset="100%" style="stop-color:#ffc107;stop-opacity:1" />
                                                        </linearGradient>
                                                    </defs>
                                                    
                                                    <g id="mouse-brain" transform="translate(100, 50)">
                                                        <ellipse class="brain-region region-visual-cortex interactive-element" cx="450" cy="180" rx="80" ry="120" fill="url(#cortexGradient)" opacity="0.8" data-region="VISp" data-activity="89.3" data-neurons="387"/>
                                                        <text class="brain-region-label" x="450" y="180">VISp</text>
                                                        
                                                        <ellipse class="brain-region region-motor-cortex interactive-element" cx="300" cy="150" rx="60" ry="100" fill="url(#motorGradient)" opacity="0.8" data-region="MOp" data-activity="67.2" data-neurons="198"/>
                                                        <text class="brain-region-label" x="300" y="150">MOp</text>
                                                        
                                                        <ellipse class="brain-region region-somatosensory interactive-element" cx="380" cy="120" rx="50" ry="80" fill="url(#motorGradient)" opacity="0.7" data-region="SSp" data-activity="58.7" data-neurons="156"/>
                                                        <text class="brain-region-label" x="380" y="120">SSp</text>
                                                        
                                                        <ellipse class="brain-region region-prefrontal interactive-element" cx="200" cy="140" rx="70" ry="90" fill="url(#cortexGradient)" opacity="0.8" data-region="ACAd" data-activity="78.4" data-neurons="234"/>
                                                        <text class="brain-region-label" x="200" y="140">ACAd</text>
                                                        
                                                        <ellipse class="brain-region region-hippocampus interactive-element" cx="320" cy="250" rx="45" ry="30" fill="url(#hippoGradient)" opacity="0.9" data-region="CA1" data-activity="64.1" data-neurons="134"/>
                                                        <text class="brain-region-label" x="320" y="250">CA1</text>
                                                        
                                                        <ellipse class="brain-region region-thalamus interactive-element" cx="350" cy="220" rx="35" ry="40" fill="url(#thalamusGradient)" opacity="0.8" data-region="LGd" data-activity="72.6" data-neurons="89"/>
                                                        <text class="brain-region-label" x="350" y="220">LGd</text>
                                                        
                                                        <ellipse class="brain-region region-striatum interactive-element" cx="280" cy="200" rx="40" ry="50" fill="url(#hippoGradient)" opacity="0.7" data-region="CP" data-activity="55.3" data-neurons="67"/>
                                                        <text class="brain-region-label" x="280" y="200">CP</text>
                                                        
                                                        <ellipse class="brain-region region-cerebellum interactive-element" cx="480" cy="320" rx="60" ry="40" fill="url(#thalamusGradient)" opacity="0.6" data-region="CB" data-activity="43.8" data-neurons="45"/>
                                                        <text class="brain-region-label" x="480" y="320">CB</text>
                                                        
                                                        <g class="electrode-sites">
                                                            <circle class="electrode-site" cx="450" cy="160" r="3" data-electrode="E001"/>
                                                            <circle class="electrode-site" cx="440" cy="190" r="3" data-electrode="E002"/>
                                                            <circle class="electrode-site" cx="300" cy="130" r="3" data-electrode="E003"/>
                                                            <circle class="electrode-site" cx="310" cy="170" r="3" data-electrode="E004"/>
                                                            <circle class="electrode-site" cx="200" cy="120" r="3" data-electrode="E005"/>
                                                            <circle class="electrode-site" cx="190" cy="160" r="3" data-electrode="E006"/>
                                                            <circle class="electrode-site" cx="320" cy="240" r="3" data-electrode="E007"/>
                                                            <circle class="electrode-site" cx="350" cy="210" r="3" data-electrode="E008"/>
                                                        </g>
                                                        
                                                        <g class="neural-connections">
                                                            <path class="neural-connection" d="M450,180 Q400,200 350,220" stroke-dasharray="2,2"/>
                                                            <path class="neural-connection" d="M300,150 Q340,185 380,220" stroke-dasharray="2,2"/>
                                                            <path class="neural-connection" d="M200,140 Q250,190 300,250" stroke-dasharray="2,2"/>
                                                            <path class="neural-connection" d="M380,120 Q365,170 350,220" stroke-dasharray="2,2"/>
                                                        </g>
                                                    </g>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="space-y-6">
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Recording Configuration</h4>
                                        <div class="space-y-3 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Total Sites:</span>
                                                <span class="font-bold">247</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Active Sites:</span>
                                                <span class="font-bold text-green-600">241</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Quality Score:</span>
                                                <span class="font-bold text-neural-600">9.1/10</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Coverage:</span>
                                                <span class="font-bold text-synapse-600">18 regions</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Depth Range:</span>
                                                <span class="font-bold">0.5-4.2mm</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Regional Activity Levels</h4>
                                        <div class="space-y-4">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center space-x-3">
                                                    <div class="w-4 h-4 bg-gradient-to-r from-red-400 to-red-600 rounded"></div>
                                                    <span class="text-sm font-medium">VISp</span>
                                                </div>
                                                <span class="text-sm font-bold text-red-600">High (89%)</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-gradient-to-r from-red-400 to-red-600 h-2 rounded-full" style="width: 89%"></div>
                                            </div>
                                            
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center space-x-3">
                                                    <div class="w-4 h-4 bg-gradient-to-r from-teal-400 to-teal-600 rounded"></div>
                                                    <span class="text-sm font-medium">ACAd</span>
                                                </div>
                                                <span class="text-sm font-bold text-teal-600">High (78%)</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-gradient-to-r from-teal-400 to-teal-600 h-2 rounded-full" style="width: 78%"></div>
                                            </div>
                                            
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center space-x-3">
                                                    <div class="w-4 h-4 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded"></div>
                                                    <span class="text-sm font-medium">LGd</span>
                                                </div>
                                                <span class="text-sm font-bold text-yellow-600">Medium (73%)</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-gradient-to-r from-yellow-400 to-yellow-600 h-2 rounded-full" style="width: 73%"></div>
                                            </div>
                                            
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center space-x-3">
                                                    <div class="w-4 h-4 bg-gradient-to-r from-blue-400 to-blue-600 rounded"></div>
                                                    <span class="text-sm font-medium">MOp</span>
                                                </div>
                                                <span class="text-sm font-bold text-blue-600">Medium (67%)</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                                <div class="bg-gradient-to-r from-blue-400 to-blue-600 h-2 rounded-full" style="width: 67%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Atlas Reference</h4>
                                        <div class="space-y-3 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Version:</span>
                                                <span class="font-bold">CCFv3.1</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Resolution:</span>
                                                <span class="font-bold">25μm isotropic</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Annotations:</span>
                                                <span class="font-bold text-green-600">Complete</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Coordinate System:</span>
                                                <span class="font-bold">Stereotaxic</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-500">Update Status:</span>
                                                <span class="font-bold text-blue-600">Current</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Activity Heatmap</h4>
                                        <div id="activity-heatmap" class="brain-heatmap w-full h-40 mb-4"></div>
                                        <div class="flex justify-between text-xs text-gray-500">
                                            <span>Low</span>
                                            <span>High</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="content-connectivity" class="tab-content hidden p-8">
                            <div class="mb-8 flex flex-col lg:flex-row lg:items-center lg:justify-between">
                                <div class="mb-6 lg:mb-0">
                                    <h3 class="text-2xl font-bold mb-2">Network Connectivity Analysis</h3>
                                    <p class="text-gray-500 dark:text-gray-400">Functional connectivity patterns and network topology across brain regions</p>
                                </div>
                                <div class="flex flex-col sm:flex-row gap-4">
                                    <select id="connectivity-method" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-neural-500 focus:border-transparent text-base">
                                        <option value="correlation">Correlation Analysis</option>
                                        <option value="granger">Granger Causality</option>
                                        <option value="coherence">Spectral Coherence</option>
                                        <option value="mutual-info">Mutual Information</option>
                                    </select>
                                    <select id="frequency-band" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-synapse-500 focus:border-transparent text-base">
                                        <option value="all">All Frequencies</option>
                                        <option value="theta">Theta (4-8 Hz)</option>
                                        <option value="alpha">Alpha (8-12 Hz)</option>
                                        <option value="beta">Beta (12-30 Hz)</option>
                                        <option value="gamma">Gamma (30-100 Hz)</option>
                                    </select>
                                    <button id="compute-connectivity" class="px-6 py-3 neural-gradient text-white rounded-xl hover:opacity-90 transition-all shadow-lg font-semibold">
                                        Compute Network
                                    </button>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                                <div class="lg:col-span-2 bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Functional Connectivity Network</h4>
                                    <div class="network-graph" id="connectivity-network"></div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Network Metrics</h4>
                                    <div class="space-y-6">
                                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl">
                                            <h5 class="text-lg font-semibold mb-4">Global Properties</h5>
                                            <div class="space-y-3 text-sm">
                                                <div class="flex justify-between">
                                                    <span class="text-gray-500">Clustering Coefficient</span>
                                                    <span class="font-bold text-neural-600">0.73</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span class="text-gray-500">Path Length</span>
                                                    <span class="font-bold text-synapse-600">2.14</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span class="text-gray-500">Small-World Index</span>
                                                    <span class="font-bold text-green-600">3.47</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span class="text-gray-500">Modularity</span>
                                                    <span class="font-bold text-blue-600">0.68</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span class="text-gray-500">Global Efficiency</span>
                                                    <span class="font-bold text-purple-600">0.52</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl">
                                            <h5 class="text-lg font-semibold mb-4">Hub Regions</h5>
                                            <div class="space-y-3">
                                                <div class="flex items-center justify-between">
                                                    <span class="text-sm font-medium">VISp</span>
                                                    <span class="text-red-600 text-sm font-bold">Hub</span>
                                                </div>
                                                <div class="flex items-center justify-between">
                                                    <span class="text-sm font-medium">ACAd</span>
                                                    <span class="text-neural-600 text-sm font-bold">Hub</span>
                                                </div>
                                                <div class="flex items-center justify-between">
                                                    <span class="text-sm font-medium">LGd</span>
                                                    <span class="text-yellow-600 text-sm font-bold">Connector</span>
                                                </div>
                                                <div class="flex items-center justify-between">
                                                    <span class="text-sm font-medium">MOp</span>
                                                    <span class="text-blue-600 text-sm font-bold">Provincial</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Connectivity Matrix</h4>
                                    <div class="w-full h-80 bg-white dark:bg-gray-800 rounded-xl">
                                        <canvas id="connectivityMatrix" class="w-full h-full rounded-xl"></canvas>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-8 analysis-panel">
                                    <h4 class="text-xl font-bold mb-6">Network Degree Distribution</h4>
                                    <div class="chart-container">
                                        <canvas id="degreeDistribution"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="content-results" class="tab-content hidden p-8">
                            <div class="mb-8">
                                <h3 class="text-2xl font-bold mb-2">Comprehensive Research Findings</h3>
                                <p class="text-gray-500 dark:text-gray-400">Complete analysis results and implications for understanding neural mechanisms of prior expectations</p>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                                <div class="lg:col-span-3 space-y-8">
                                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 analysis-panel">
                                        <h4 class="text-2xl font-bold mb-6">Primary Research Findings</h4>
                                        <div class="space-y-6">
                                            <div class="p-6 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border border-green-200 dark:border-green-700 rounded-xl">
                                                <div class="flex items-start space-x-4">
                                                    <div class="w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center flex-shrink-0">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <h5 class="text-xl font-bold text-green-800 dark:text-green-200 mb-2">Strong Behavioral Prior Effects</h5>
                                                        <p class="text-green-700 dark:text-green-300 mb-3">Mice demonstrate robust biasing of choices by block-wise priors, especially at zero contrast conditions (p &lt; 0.001, Cohen's d = 0.87)</p>
                                                        <div class="grid grid-cols-2 gap-4 text-sm">
                                                            <div>
                                                                <span class="text-green-600 font-semibold">Left Prior Bias:</span>
                                                                <div class="text-green-800 dark:text-green-200 font-bold">72.8% ± 8.4%</div>
                                                            </div>
                                                            <div>
                                                                <span class="text-green-600 font-semibold">Right Prior Bias:</span>
                                                                <div class="text-green-800 dark:text-green-200 font-bold">69.4% ± 7.9%</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="p-6 bg-gradient-to-r from-neural-50 to-neural-100 dark:from-neural-900/20 dark:to-neural-800/20 border border-neural-200 dark:border-neural-700 rounded-xl">
                                                <div class="flex items-start space-x-4">
                                                    <div class="w-12 h-12 bg-neural-500 rounded-xl flex items-center justify-center flex-shrink-0">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                            <circle cx="12" cy="12" r="3"></circle>
                                                            <path d="M12 1v6m0 6v6"></path>
                                                            <path d="M1 12h6m6 0h6"></path>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <h5 class="text-xl font-bold text-neural-800 dark:text-neural-200 mb-2">Distributed Neural Encoding</h5>
                                                        <p class="text-neural-700 dark:text-neural-300 mb-3">28.3% of recorded neurons show significant prior encoding across multiple brain regions, with hierarchical organization favoring higher-order areas</p>
                                                        <div class="grid grid-cols-3 gap-4 text-sm">
                                                            <div>
                                                                <span class="text-neural-600 font-semibold">Visual Areas:</span>
                                                                <div class="text-neural-800 dark:text-neural-200 font-bold">23.0% significant</div>
                                                            </div>
                                                            <div>
                                                                <span class="text-neural-600 font-semibold">Frontal Areas:</span>
                                                                <div class="text-neural-800 dark:text-neural-200 font-bold">38.0% significant</div>
                                                            </div>
                                                            <div>
                                                                <span class="text-neural-600 font-semibold">Hippocampus:</span>
                                                                <div class="text-neural-800 dark:text-neural-200 font-bold">29.1% significant</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="p-6 bg-gradient-to-r from-synapse-50 to-synapse-100 dark:from-synapse-900/20 dark:to-synapse-800/20 border border-synapse-200 dark:border-synapse-700 rounded-xl">
                                                <div class="flex items-start space-x-4">
                                                    <div class="w-12 h-12 bg-synapse-500 rounded-xl flex items-center justify-center flex-shrink-0">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                            <path d="M3 3v18h18"></path>
                                                            <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"></path>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <h5 class="text-xl font-bold text-synapse-800 dark:text-synapse-200 mb-2">Distinct Population Trajectories</h5>
                                                        <p class="text-synapse-700 dark:text-synapse-300 mb-3">PCA analysis reveals separable neural population trajectories for different prior conditions, with 89.3% variance explained by first 5 components</p>
                                                        <div class="grid grid-cols-2 gap-4 text-sm">
                                                            <div>
                                                                <span class="text-synapse-600 font-semibold">Trajectory Separation:</span>
                                                                <div class="text-synapse-800 dark:text-synapse-200 font-bold">Highly Significant</div>
                                                            </div>
                                                            <div>
                                                                <span class="text-synapse-600 font-semibold">Cross-validation:</span>
                                                                <div class="text-synapse-800 dark:text-synapse-200 font-bold">96.8% accuracy</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="p-6 bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 border border-purple-200 dark:border-purple-700 rounded-xl">
                                                <div class="flex items-start space-x-4">
                                                    <div class="w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center flex-shrink-0">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                            <path d="m6 6 12 12"></path>
                                                            <path d="m6 18 12-12"></path>
                                                            <path d="M12 12h.01"></path>
                                                        </svg>
                                                    </div>
                                                    <div>
                                                        <h5 class="text-xl font-bold text-purple-800 dark:text-purple-200 mb-2">Functional Network Organization</h5>
                                                        <p class="text-purple-700 dark:text-purple-300 mb-3">Strong functional connectivity between visual and frontal areas during prior-based decision making, with small-world network properties</p>
                                                        <div class="grid grid-cols-2 gap-4 text-sm">
                                                            <div>
                                                                <span class="text-purple-600 font-semibold">VISp-ACAd:</span>
                                                                <div class="text-purple-800 dark:text-purple-200 font-bold">r = 0.73</div>
                                                            </div>
                                                            <div>
                                                                <span class="text-purple-600 font-semibold">Small-world Index:</span>
                                                                <div class="text-purple-800 dark:text-purple-200 font-bold">3.47</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 analysis-panel">
                                        <h4 class="text-2xl font-bold mb-6">Mechanistic Insights and Implications</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                            <div>
                                                <h5 class="text-xl font-semibold mb-4 text-neural-600">Neural Mechanisms</h5>
                                                <div class="space-y-4">
                                                    <div class="flex items-start space-x-3">
                                                        <div class="w-2 h-2 bg-neural-500 rounded-full mt-2 flex-shrink-0"></div>
                                                        <div>
                                                            <h6 class="font-semibold">Predictive Coding Framework</h6>
                                                            <p class="text-sm text-gray-600 dark:text-gray-400">Prior expectations implemented through top-down signals modulating sensory processing</p>
                                                        </div>
                                                    </div>
                                                    <div class="flex items-start space-x-3">
                                                        <div class="w-2 h-2 bg-synapse-500 rounded-full mt-2 flex-shrink-0"></div>
                                                        <div>
                                                            <h6 class="font-semibold">Hierarchical Processing</h6>
                                                            <p class="text-sm text-gray-600 dark:text-gray-400">Stronger prior effects in higher-order areas suggest hierarchical information flow</p>
                                                        </div>
                                                    </div>
                                                    <div class="flex items-start space-x-3">
                                                        <div class="w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"></div>
                                                        <div>
                                                            <h6 class="font-semibold">Population Dynamics</h6>
                                                            <p class="text-sm text-gray-600 dark:text-gray-400">Low-dimensional manifolds encode prior information across neural populations</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div>
                                                <h5 class="text-xl font-semibold mb-4 text-green-600">Clinical Relevance</h5>
                                                <div class="space-y-4">
                                                    <div class="flex items-start space-x-3">
                                                        <div class="w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"></div>
                                                        <div>
                                                            <h6 class="font-semibold">Psychiatric Disorders</h6>
                                                            <p class="text-sm text-gray-600 dark:text-gray-400">Altered prior processing implicated in schizophrenia and autism spectrum disorders</p>
                                                        </div>
                                                    </div>
                                                    <div class="flex items-start space-x-3">
                                                        <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"></div>
                                                        <div>
                                                            <h6 class="font-semibold">Learning Disabilities</h6>
                                                            <p class="text-sm text-gray-600 dark:text-gray-400">Prior-based learning mechanisms crucial for adaptive behavior</p>
                                                        </div>
                                                    </div>
                                                    <div class="flex items-start space-x-3">
                                                        <div class="w-2 h-2 bg-purple-500 rounded-full mt-2 flex-shrink-0"></div>
                                                        <div>
                                                            <h6 class="font-semibold">Therapeutic Targets</h6>
                                                            <p class="text-sm text-gray-600 dark:text-gray-400">Network connectivity patterns suggest intervention strategies</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 analysis-panel">
                                        <h4 class="text-2xl font-bold mb-6">Future Research Directions</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                            <div class="p-6 bg-neural-50 dark:bg-neural-900/20 rounded-xl border border-neural-200 dark:border-neural-700">
                                                <h5 class="text-lg font-semibold mb-3 text-neural-600">Computational Modeling</h5>
                                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
                                                    <li>• Bayesian brain models of prior integration</li>
                                                    <li>• Neural network implementations</li>
                                                    <li>• Predictive coding frameworks</li>
                                                    <li>• Hierarchical message passing</li>
                                                </ul>
                                            </div>
                                            
                                            <div class="p-6 bg-synapse-50 dark:bg-synapse-900/20 rounded-xl border border-synapse-200 dark:border-synapse-700">
                                                <h5 class="text-lg font-semibold mb-3 text-synapse-600">Causal Interventions</h5>
                                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
                                                    <li>• Optogenetic manipulation of prior signals</li>
                                                    <li>• Pharmacological modulation studies</li>
                                                    <li>• Lesion and inactivation experiments</li>
                                                    <li>• Real-time neurofeedback</li>
                                                </ul>
                                            </div>
                                            
                                            <div class="p-6 bg-green-50 dark:bg-green-900/20 rounded-xl border border-green-200 dark:border-green-700">
                                                <h5 class="text-lg font-semibold mb-3 text-green-600">Cross-Species Studies</h5>
                                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
                                                    <li>• Human fMRI comparisons</li>
                                                    <li>• Non-human primate recordings</li>
                                                    <li>• Developmental trajectories</li>
                                                    <li>• Individual difference analysis</li>
                                                </ul>
                                            </div>
                                            
                                            <div class="p-6 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-700">
                                                <h5 class="text-lg font-semibold mb-3 text-blue-600">Technical Advances</h5>
                                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
                                                    <li>• Higher-density recording arrays</li>
                                                    <li>• Improved spike sorting algorithms</li>
                                                    <li>• Multi-modal data integration</li>
                                                    <li>• Real-time analysis pipelines</li>
                                                </ul>
                                            </div>
                                            
                                            <div class="p-6 bg-purple-50 dark:bg-purple-900/20 rounded-xl border border-purple-200 dark:border-purple-700">
                                                <h5 class="text-lg font-semibold mb-3 text-purple-600">Clinical Translation</h5>
                                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
                                                    <li>• Biomarker development</li>
                                                    <li>• Diagnostic applications</li>
                                                    <li>• Treatment monitoring</li>
                                                    <li>• Personalized medicine approaches</li>
                                                </ul>
                                            </div>
                                            
                                            <div class="p-6 bg-yellow-50 dark:bg-yellow-900/20 rounded-xl border border-yellow-200 dark:border-yellow-700">
                                                <h5 class="text-lg font-semibold mb-3 text-yellow-600">Behavioral Extensions</h5>
                                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
                                                    <li>• Multi-sensory integration</li>
                                                    <li>• Social context effects</li>
                                                    <li>• Emotional modulation</li>
                                                    <li>• Memory-based priors</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="space-y-6">
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Key Statistics Summary</h4>
                                        <div class="space-y-4">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Total Recording Sessions</span>
                                                <span class="text-lg font-bold text-neural-600">156</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Behavioral Trials</span>
                                                <span class="text-lg font-bold text-synapse-600">8,456</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Recorded Neurons</span>
                                                <span class="text-lg font-bold text-green-600">2,847</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Brain Regions</span>
                                                <span class="text-lg font-bold text-blue-600">18</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Recording Sites</span>
                                                <span class="text-lg font-bold text-purple-600">247</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm font-medium">Analysis Duration</span>
                                                <span class="text-lg font-bold text-indigo-600">3.2 months</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Statistical Significance</h4>
                                        <div class="space-y-4">
                                            <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm font-medium">Overall Effect</span>
                                                    <span class="text-lg font-bold text-green-600">p &lt; 0.001</span>
                                                </div>
                                            </div>
                                            <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm font-medium">Effect Size (η²)</span>
                                                    <span class="text-lg font-bold text-neural-600">0.23</span>
                                                </div>
                                            </div>
                                            <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm font-medium">Statistical Power</span>
                                                    <span class="text-lg font-bold text-synapse-600">0.98</span>
                                                </div>
                                            </div>
                                            <div class="bg-white dark:bg-gray-800 p-4 rounded-xl">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm font-medium">Confidence Interval</span>
                                                    <span class="text-lg font-bold text-blue-600">95%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Research Team</h4>
                                        <div class="space-y-3 text-sm">
                                            <div class="flex items-center space-x-3">
                                                <div class="w-8 h-8 bg-neural-500 rounded-full flex items-center justify-center">
                                                    <span class="text-white font-semibold text-xs">SA</span>
                                                </div>
                                                <div>
                                                    <p class="font-semibold">Sepideh Akbari</p>
                                                    <p class="text-gray-500">Lead Data Analyst</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-8 h-8 bg-synapse-500 rounded-full flex items-center justify-center">
                                                    <span class="text-white font-semibold text-xs">MB</span>
                                                </div>
                                                <div>
                                                    <p class="font-semibold">Matin Baghanbari</p>
                                                    <p class="text-gray-500">Data Processing</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                                    <span class="text-white font-semibold text-xs">KE</span>
                                                </div>
                                                <div>
                                                    <p class="font-semibold">Khashayar Esmaeilzadeh</p>
                                                    <p class="text-gray-500">Computational Modeling</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                                    <span class="text-white font-semibold text-xs">MG</span>
                                                </div>
                                                <div>
                                                    <p class="font-semibold">Mohammad Ghazimoghadam</p>
                                                    <p class="text-gray-500">Statistical Analysis</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center">
                                                    <span class="text-white font-semibold text-xs">SI</span>
                                                </div>
                                                <div>
                                                    <p class="font-semibold">Sina Imani</p>
                                                    <p class="text-gray-500">Data Visualization</p>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <div class="w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center">
                                                    <span class="text-white font-semibold text-xs">GK</span>
                                                </div>
                                                <div>
                                                    <p class="font-semibold">Ghazaleh Khosravi</p>
                                                    <p class="text-gray-500">Neural Analysis</p>
                                                </div>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-3 text-center">+ 5 additional contributors</p>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-2xl p-6 analysis-panel">
                                        <h4 class="text-lg font-bold mb-4">Publication Package</h4>
                                        <div class="space-y-3">
                                            <button class="w-full text-left p-4 bg-white dark:bg-gray-800 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-all group">
                                                <div class="flex items-center space-x-3">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-red-600 group-hover:scale-110 transition-transform">
                                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                                        <polyline points="14 2 14 8 20 8"></polyline>
                                                    </svg>
                                                    <div>
                                                        <p class="text-sm font-semibold">Manuscript Draft</p>
                                                        <p class="text-xs text-gray-500">Complete research paper with all analyses</p>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="w-full text-left p-4 bg-white dark:bg-gray-800 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-all group">
                                                <div class="flex items-center space-x-3">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 group-hover:scale-110 transition-transform">
                                                        <rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect>
                                                        <circle cx="9" cy="9" r="2"></circle>
                                                        <path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path>
                                                    </svg>
                                                    <div>
                                                        <p class="text-sm font-semibold">Figure Package</p>
                                                        <p class="text-xs text-gray-500">High-resolution publication figures</p>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="w-full text-left p-4 bg-white dark:bg-gray-800 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-all group">
                                                <div class="flex items-center space-x-3">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-600 group-hover:scale-110 transition-transform">
                                                        <path d="M3 3v18h18"></path>
                                                        <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"></path>
                                                    </svg>
                                                    <div>
                                                        <p class="text-sm font-semibold">Statistical Report</p>
                                                        <p class="text-xs text-gray-500">Comprehensive statistical analysis</p>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="w-full text-left p-4 bg-white dark:bg-gray-800 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-all group">
                                                <div class="flex items-center space-x-3">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-purple-600 group-hover:scale-110 transition-transform">
                                                        <polyline points="16 18 22 12 16 6"></polyline>
                                                        <polyline points="8 6 2 12 8 18"></polyline>
                                                    </svg>
                                                    <div>
                                                        <p class="text-sm font-semibold">Analysis Code</p>
                                                        <p class="text-xs text-gray-500">Reproducible analysis pipeline</p>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div id="notification-container" class="fixed bottom-4 right-4 z-50 flex flex-col space-y-3 w-80 md:w-96"></div>
        <div id="tooltip" class="popup-tooltip"></div>
    </div>

    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
        
        document.getElementById('darkModeToggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });
        
        function createMatrixRain() {
            const container = document.getElementById('matrix-rain');
            if (!container) return;
            
            const chars = '0123456789ABCDEF';
            const columns = Math.floor(window.innerWidth / 20);
            
            for (let i = 0; i < 50; i++) {
                const char = document.createElement('div');
                char.className = 'matrix-char';
                char.textContent = chars.charAt(Math.floor(Math.random() * chars.length));
                char.style.left = Math.random() * 100 + '%';
                char.style.animationDelay = Math.random() * 3 + 's';
                char.style.fontSize = (Math.random() * 8 + 10) + 'px';
                container.appendChild(char);
            }
        }
        
        function generateActivityHeatmap() {
            const container = document.getElementById('activity-heatmap');
            if (!container) return;
            
            container.innerHTML = '';
            for (let i = 0; i < 400; i++) {
                const cell = document.createElement('div');
                cell.className = 'heatmap-cell activity-heatmap';
                
                const activity = Math.random();
                if (activity > 0.8) cell.classList.add('activity-5');
                else if (activity > 0.6) cell.classList.add('activity-4');
                else if (activity > 0.4) cell.classList.add('activity-3');
                else if (activity > 0.2) cell.classList.add('activity-2');
                else if (activity > 0.1) cell.classList.add('activity-1');
                
                cell.addEventListener('mouseenter', function(e) {
                    const tooltip = document.getElementById('tooltip');
                    tooltip.textContent = `Activity: ${(activity * 100).toFixed(1)}%`;
                    tooltip.style.left = e.pageX + 10 + 'px';
                    tooltip.style.top = e.pageY - 10 + 'px';
                    tooltip.classList.add('show');
                });
                
                cell.addEventListener('mouseleave', function() {
                    document.getElementById('tooltip').classList.remove('show');
                });
                
                container.appendChild(cell);
            }
        }
        
        function generateSpikeRaster() {
            const container = document.getElementById('spike-dots');
            if (!container) return;
            
            container.innerHTML = '';
            for (let i = 0; i < 200; i++) {
                const spike = document.createElement('div');
                spike.className = 'neuron-spike';
                spike.style.left = Math.random() * 100 + '%';
                spike.style.top = Math.random() * 100 + '%';
                spike.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(spike);
            }
        }
        
        function addBrainInteractivity() {
            const brainRegions = document.querySelectorAll('.brain-region');
            const electrodes = document.querySelectorAll('.electrode-site');
            
            brainRegions.forEach(region => {
                region.addEventListener('mouseenter', function(e) {
                    const tooltip = document.getElementById('tooltip');
                    const regionName = this.getAttribute('data-region');
                    const activity = this.getAttribute('data-activity');
                    const neurons = this.getAttribute('data-neurons');
                    
                    tooltip.innerHTML = `
                        <strong>${regionName}</strong><br>
                        Activity: ${activity}%<br>
                        Neurons: ${neurons}
                    `;
                    tooltip.style.left = e.pageX + 10 + 'px';
                    tooltip.style.top = e.pageY - 10 + 'px';
                    tooltip.classList.add('show');
                });
                
                region.addEventListener('mouseleave', function() {
                    document.getElementById('tooltip').classList.remove('show');
                });
            });
            
            electrodes.forEach(electrode => {
                electrode.addEventListener('mouseenter', function(e) {
                    const tooltip = document.getElementById('tooltip');
                    const electrodeId = this.getAttribute('data-electrode');
                    
                    tooltip.innerHTML = `
                        <strong>Electrode ${electrodeId}</strong><br>
                        Status: Active<br>
                        Quality: 9.2/10
                    `;
                    tooltip.style.left = e.pageX + 10 + 'px';
                    tooltip.style.top = e.pageY - 10 + 'px';
                    tooltip.classList.add('show');
                });
                
                electrode.addEventListener('mouseleave', function() {
                    document.getElementById('tooltip').classList.remove('show');
                });
            });
        }
        
        class AdvancedSnazzyInariSystem {
            constructor() {
                this.researcherId = '';
                this.accessToken = '';
                this.neuralData = {};
                this.charts = {};
                this.isAnimating = false;
                this.currentDataStream = null;
                this.initEventListeners();
                this.initAnimations();
            }
            
            initEventListeners() {
                document.getElementById('auth-form').addEventListener('submit', this.handleAuth.bind(this));
                
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', this.handleTabChange.bind(this));
                });
                
                document.getElementById('refresh-btn').addEventListener('click', this.refreshData.bind(this));
                document.getElementById('export-data-btn').addEventListener('click', this.exportData.bind(this));
                document.getElementById('analysis-btn').addEventListener('click', this.runAdvancedAnalysis.bind(this));
                document.getElementById('play-animation').addEventListener('click', this.toggleAnimation.bind(this));
                document.getElementById('run-pca').addEventListener('click', this.runPCAAnalysis.bind(this));
                document.getElementById('analyze-units').addEventListener('click', this.analyzeSelectedUnits.bind(this));
                document.getElementById('update-map').addEventListener('click', this.updateBrainMap.bind(this));
                document.getElementById('compute-connectivity').addEventListener('click', this.computeConnectivity.bind(this));
            }
            
            initAnimations() {
                createMatrixRain();
                generateActivityHeatmap();
                generateSpikeRaster();
                addBrainInteractivity();
                this.startRealTimeUpdates();
            }
            
            async handleAuth(event) {
                event.preventDefault();
                
                const researcherId = document.getElementById('username').value.trim();
                const accessToken = document.getElementById('token').value.trim();
                
                if (!researcherId || !accessToken) {
                    this.showNotification('Please enter your researcher ID and IBL access token', 'error');
                    return;
                }
                
                try {
                    this.showNotification('Authenticating with International Brain Laboratory...', 'info');
                    
                    await new Promise(resolve => setTimeout(resolve, 2500));
                    
                    this.researcherId = researcherId;
                    this.accessToken = accessToken;
                    
                    document.getElementById('auth-screen').classList.add('hidden');
                    document.getElementById('dashboard').classList.remove('hidden');
                    
                    this.loadAdvancedNeuralData();
                    this.showNotification('Successfully connected to IBL! Loading advanced neural analysis...', 'success');
                } catch (error) {
                    this.showNotification(`Authentication failed: ${error.message}`, 'error');
                }
            }
            
            async loadAdvancedNeuralData() {
                try {
                    this.showNotification('Initializing advanced neural analysis pipeline...', 'info');
                    
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    this.createAdvancedNeuralActivityChart();
                    this.createEnhancedBrainRegionChart();
                    this.initializeAdvancedCharts();
                    this.startAdvancedAnalysis();
                    
                    this.showNotification('Advanced neural analysis complete! All systems operational.', 'success');
                } catch (error) {
                    this.showNotification(`Failed to load neural data: ${error.message}`, 'error');
                }
            }
            
            createAdvancedNeuralActivityChart() {
                const ctx = document.getElementById('neuralActivityChart');
                if (!ctx) return;
                
                if (this.charts.neuralActivity) {
                    this.charts.neuralActivity.destroy();
                }
                
                const timePoints = [];
                const leftPriorData = [];
                const rightPriorData = [];
                const stimulusOnset = [];
                const decisionPeriod = [];
                const feedbackPeriod = [];
                
                for (let i = 0; i <= 100; i++) {
                    const time = i * 10;
                    timePoints.push(time);
                    
                    const baseActivity = 20;
                    const noise = (Math.random() - 0.5) * 8;
                    
                    let leftActivity = baseActivity + noise;
                    let rightActivity = baseActivity + noise;
                    
                    if (time >= 200 && time <= 700) {
                        leftActivity += 25 * Math.exp(-(time - 300) * (time - 300) / 10000) + 15;
                        rightActivity += 20 * Math.exp(-(time - 350) * (time - 350) / 12000) + 10;
                    }
                    
                    if (time >= 500 && time <= 800) {
                        leftActivity += 30 * Math.sin((time - 500) * 0.02) + 12;
                        rightActivity += 25 * Math.sin((time - 550) * 0.025) + 8;
                    }
                    
                    leftPriorData.push(Math.max(0, leftActivity));
                    rightPriorData.push(Math.max(0, rightActivity));
                    
                    if (time >= 200 && time <= 250) {
                        stimulusOnset.push({ x: time, y: leftActivity + 10 });
                    }
                    if (time >= 500 && time <= 750) {
                        decisionPeriod.push({ x: time, y: (leftActivity + rightActivity) / 2 + 20 });
                    }
                    if (time >= 800 && time <= 900) {
                        feedbackPeriod.push({ x: time, y: 15 + Math.random() * 10 });
                    }
                }
                
                this.charts.neuralActivity = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: timePoints,
                        datasets: [{
                            label: 'Left Prior Block',
                            data: leftPriorData,
                            borderColor: '#0ea5e9',
                            backgroundColor: 'rgba(14, 165, 233, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointRadius: 0,
                            borderWidth: 3
                        }, {
                            label: 'Right Prior Block',
                            data: rightPriorData,
                            borderColor: '#d946ef',
                            backgroundColor: 'rgba(217, 70, 239, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointRadius: 0,
                            borderWidth: 3
                        }, {
                            label: 'Stimulus Period',
                            data: stimulusOnset,
                            borderColor: '#22c55e',
                            backgroundColor: 'rgba(34, 197, 94, 0.2)',
                            tension: 0.3,
                            fill: false,
                            pointRadius: 2,
                            borderWidth: 2,
                            borderDash: [5, 5]
                        }, {
                            label: 'Decision Period',
                            data: decisionPeriod,
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.2)',
                            tension: 0.3,
                            fill: false,
                            pointRadius: 1,
                            borderWidth: 2,
                            borderDash: [3, 3]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: '#ffffff',
                                bodyColor: '#ffffff',
                                borderColor: '#5D5CDE',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Population Firing Rate (Hz)',
                                    font: {
                                        size: 14,
                                        weight: 'bold'
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time from Trial Start (ms)',
                                    font: {
                                        size: 14,
                                        weight: 'bold'
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        animation: {
                            duration: 2000,
                            easing: 'easeInOutQuart'
                        }
                    }
                });
            }
            
            createEnhancedBrainRegionChart() {
                const ctx = document.getElementById('brainRegionChart');
                if (!ctx) return;
                
                if (this.charts.brainRegion) {
                    this.charts.brainRegion.destroy();
                }
                
                const regions = ['VISp', 'ACAd', 'MOp', 'SSp', 'CA1', 'LGd', 'CP', 'ORBvl', 'PL', 'ILA', 'VPM', 'POm', 'MOs', 'RSP', 'PTLp', 'VISl', 'VISal', 'Others'];
                const neuronCounts = [387, 234, 198, 156, 134, 89, 67, 62, 45, 43, 38, 35, 31, 28, 25, 23, 21, 432];
                const colors = [
                    '#ff6b6b', '#4ecdc4', '#45b7d1', '#f7b733', '#5f27cd', 
                    '#00d2d3', '#ff9ff3', '#54a0ff', '#ff6348', '#7bed9f',
                    '#70a1ff', '#5352ed', '#ff4757', '#2ed573', '#3742fa',
                    '#ff3838', '#2f3542', '#57606f'
                ];
                
                this.charts.brainRegion = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: regions,
                        datasets: [{
                            data: neuronCounts,
                            backgroundColor: colors,
                            borderWidth: 3,
                            borderColor: '#ffffff',
                            hoverBorderWidth: 4,
                            hoverBorderColor: '#5D5CDE'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    usePointStyle: true,
                                    padding: 15,
                                    font: {
                                        size: 11
                                    }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: '#ffffff',
                                bodyColor: '#ffffff',
                                borderColor: '#5D5CDE',
                                borderWidth: 1,
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.parsed;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return `${label}: ${value} neurons (${percentage}%)`;
                                    }
                                }
                            }
                        },
                        animation: {
                            animateRotate: true,
                            duration: 2000
                        }
                    }
                });
            }
            
            initializeAdvancedCharts() {
                this.createPsthChart();
                this.createNeuronRasterCharts();
                this.createTuningCurveChart();
                this.createSpatialChart();
            }
            
            createPsthChart() {
                const ctx = document.getElementById('psthChart');
                if (!ctx) return;
                
                const psth = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: Array.from({length: 20}, (_, i) => i * 50),
                        datasets: [{
                            label: 'Firing Rate',
                            data: Array.from({length: 20}, () => Math.random() * 30 + 5),
                            backgroundColor: 'rgba(14, 165, 233, 0.6)',
                            borderColor: '#0ea5e9',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Hz'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time (ms)'
                                }
                            }
                        }
                    }
                });
            }
            
            createNeuronRasterCharts() {
                ['neuron1-raster', 'neuron2-psth', 'neuron3-tuning', 'neuron4-spatial'].forEach((id, index) => {
                    const ctx = document.getElementById(id);
                    if (!ctx) return;
                    
                    let chartData;
                    if (index === 0) {
                        chartData = {
                            type: 'scatter',
                            data: {
                                datasets: [{
                                    label: 'Spikes',
                                    data: Array.from({length: 50}, () => ({
                                        x: Math.random() * 1000,
                                        y: Math.random() * 20
                                    })),
                                    backgroundColor: '#0ea5e9',
                                    pointRadius: 1
                                }]
                            }
                        };
                    } else if (index === 1) {
                        chartData = {
                            type: 'line',
                            data: {
                                labels: Array.from({length: 30}, (_, i) => i * 33),
                                datasets: [{
                                    label: 'PSTH',
                                    data: Array.from({length: 30}, (_, i) => 
                                        10 + 15 * Math.exp(-Math.pow(i - 15, 2) / 50) + Math.random() * 5
                                    ),
                                    borderColor: '#d946ef',
                                    backgroundColor: 'rgba(217, 70, 239, 0.1)',
                                    tension: 0.4,
                                    fill: true
                                }]
                            }
                        };
                    } else if (index === 2) {
                        chartData = {
                            type: 'line',
                            data: {
                                labels: [-100, -50, -25, -12.5, 0, 12.5, 25, 50, 100],
                                datasets: [{
                                    label: 'Tuning Curve',
                                    data: [5, 8, 12, 18, 25, 20, 14, 9, 6],
                                    borderColor: '#22c55e',
                                    backgroundColor: 'rgba(34, 197, 94, 0.1)',
                                    tension: 0.3,
                                    fill: true
                                }]
                            }
                        };
                    } else {
                        chartData = {
                            type: 'scatter',
                            data: {
                                datasets: [{
                                    label: 'Spatial Response',
                                    data: Array.from({length: 25}, () => ({
                                        x: Math.random() * 100,
                                        y: Math.random() * 100
                                    })),
                                    backgroundColor: Array.from({length: 25}, () => 
                                        `rgba(147, 51, 234, ${Math.random() * 0.8 + 0.2})`
                                    ),
                                    pointRadius: Array.from({length: 25}, () => Math.random() * 8 + 2)
                                }]
                            }
                        };
                    }
                    
                    new Chart(ctx, {
                        ...chartData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true
                                },
                                x: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                });
            }
            
            createTuningCurveChart() {
                const ctx = document.getElementById('psychometricChart');
                if (!ctx) return;
                
                const contrasts = [-100, -50, -25, -12.5, -6.25, 0, 6.25, 12.5, 25, 50, 100];
                const leftPriorData = [0.95, 0.88, 0.76, 0.68, 0.62, 0.73, 0.48, 0.35, 0.22, 0.12, 0.05];
                const rightPriorData = [0.95, 0.91, 0.82, 0.71, 0.58, 0.27, 0.38, 0.29, 0.18, 0.08, 0.05];
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: contrasts,
                        datasets: [{
                            label: 'Left Prior Block',
                            data: leftPriorData,
                            borderColor: '#0ea5e9',
                            backgroundColor: 'rgba(14, 165, 233, 0.1)',
                            tension: 0.4,
                            borderWidth: 3,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }, {
                            label: 'Right Prior Block',
                            data: rightPriorData,
                            borderColor: '#d946ef',
                            backgroundColor: 'rgba(217, 70, 239, 0.1)',
                            tension: 0.4,
                            borderWidth: 3,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: '#ffffff',
                                bodyColor: '#ffffff',
                                borderColor: '#5D5CDE',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 1,
                                title: {
                                    display: true,
                                    text: 'P(Choose Right)',
                                    font: {
                                        size: 14,
                                        weight: 'bold'
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Contrast Level (%)',
                                    font: {
                                        size: 14,
                                        weight: 'bold'
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            createSpatialChart() {
                const ctx = document.getElementById('varianceChart');
                if (!ctx) return;
                
                const components = ['PC1', 'PC2', 'PC3', 'PC4', 'PC5', 'PC6', 'PC7', 'PC8'];
                const variance = [47.3, 26.8, 15.2, 8.4, 5.7, 3.1, 1.8, 1.2];
                const cumulative = variance.reduce((acc, val, i) => {
                    acc.push((acc[i-1] || 0) + val);
                    return acc;
                }, []);
                
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: components,
                        datasets: [{
                            label: 'Individual Variance (%)',
                            data: variance,
                            backgroundColor: [
                                '#0ea5e9', '#d946ef', '#22c55e', '#f59e0b',
                                '#8b5cf6', '#ef4444', '#06b6d4', '#84cc16'
                            ],
                            borderWidth: 2,
                            borderColor: '#ffffff'
                        }, {
                            label: 'Cumulative Variance (%)',
                            data: cumulative,
                            type: 'line',
                            borderColor: '#5D5CDE',
                            backgroundColor: 'rgba(93, 92, 222, 0.1)',
                            tension: 0.3,
                            fill: false,
                            borderWidth: 3,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Variance Explained (%)',
                                    font: {
                                        size: 14,
                                        weight: 'bold'
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            startAdvancedAnalysis() {
                this.simulateRealTimeNeuralActivity();
                this.updateStatisticsDisplay();
                this.createConnectivityVisualization();
            }
            
            simulateRealTimeNeuralActivity() {
                setInterval(() => {
                    const activityFeed = document.getElementById('activity-feed');
                    if (activityFeed && Math.random() < 0.3) {
                        const activities = [
                            { type: 'VISp Strong Response', location: 'Visual cortex shows enhanced prior encoding', priority: 'HIGH', color: 'neural' },
                            { type: 'ACAd Decision Signal', location: 'Anterior cingulate decision-related activity', priority: 'MOD', color: 'synapse' },
                            { type: 'MOp Motor Preparation', location: 'Motor cortex preparatory activity detected', priority: 'NEW', color: 'green' },
                            { type: 'CA1 Place Coding', location: 'Hippocampal spatial representation active', priority: 'LOW', color: 'blue' },
                            { type: 'LGd Thalamic Relay', location: 'Lateral geniculate nucleus activity', priority: 'SIG', color: 'purple' },
                            { type: 'SSp Sensory Processing', location: 'Somatosensory cortex tactile response', priority: 'MOD', color: 'yellow' }
                        ];
                        
                        const activity = activities[Math.floor(Math.random() * activities.length)];
                        
                        const newActivity = document.createElement('div');
                        newActivity.className = 'flex items-center space-x-3 p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm animate-slide-up';
                        newActivity.innerHTML = `
                            <div class="w-3 h-3 bg-${activity.color}-500 rounded-full animate-pulse"></div>
                            <div class="flex-1">
                                <p class="text-sm font-semibold">${activity.type}</p>
                                <p class="text-xs text-gray-500">${activity.location} - just now</p>
                            </div>
                            <span class="text-xs px-2 py-1 bg-${activity.color}-100 text-${activity.color}-800 rounded-full font-medium">${activity.priority}</span>
                        `;
                        
                        activityFeed.insertBefore(newActivity, activityFeed.firstChild);
                        
                        if (activityFeed.children.length > 8) {
                            activityFeed.removeChild(activityFeed.lastChild);
                        }
                    }
                }, 8000);
            }
            
            startRealTimeUpdates() {
                setInterval(() => {
                    this.updateMetrics();
                    this.updateProcessingStatus();
                }, 15000);
            }
            
            updateMetrics() {
                const metrics = [
                    { id: 'total-neurons', base: 2847, variance: 50 },
                    { id: 'prior-effect', base: 73.2, variance: 3, suffix: '%' },
                    { id: 'total-trials', base: 8456, variance: 100 },
                    { id: 'model-accuracy', base: 96.8, variance: 1, suffix: '%' },
                    { id: 'pca-variance', base: 84.7, variance: 2, suffix: '%' }
                ];
                
                metrics.forEach(metric => {
                    const element = document.getElementById(metric.id);
                    if (element) {
                        const newValue = metric.base + (Math.random() - 0.5) * metric.variance;
                        const displayValue = metric.suffix ? 
                            newValue.toFixed(1) + metric.suffix : 
                            Math.round(newValue).toLocaleString();
                        element.textContent = displayValue;
                    }
                });
            }
            
            updateProcessingStatus() {
                const statusElements = document.querySelectorAll('.progress-bar');
                statusElements.forEach(bar => {
                    const currentWidth = parseInt(bar.style.width) || 0;
                    const targetWidth = Math.min(100, currentWidth + Math.random() * 5);
                    bar.style.width = targetWidth + '%';
                });
            }
            
            createConnectivityVisualization() {
                const container = document.getElementById('connectivity-network');
                if (!container) return;
                
                const svg = d3.select(container)
                    .append('svg')
                    .attr('width', '100%')
                    .attr('height', '100%')
                    .attr('viewBox', '0 0 400 400');
                
                const nodes = [
                    { id: 'VISp', x: 200, y: 80, size: 15 },
                    { id: 'ACAd', x: 120, y: 150, size: 12 },
                    { id: 'MOp', x: 280, y: 150, size: 10 },
                    { id: 'SSp', x: 340, y: 200, size: 8 },
                    { id: 'CA1', x: 200, y: 250, size: 9 },
                    { id: 'LGd', x: 150, y: 320, size: 7 },
                    { id: 'CP', x: 250, y: 320, size: 6 }
                ];
                
                const links = [
                    { source: 'VISp', target: 'ACAd', strength: 0.8 },
                    { source: 'VISp', target: 'LGd', strength: 0.9 },
                    { source: 'ACAd', target: 'MOp', strength: 0.6 },
                    { source: 'MOp', target: 'SSp', strength: 0.7 },
                    { source: 'CA1', target: 'ACAd', strength: 0.5 },
                    { source: 'CP', target: 'MOp', strength: 0.4 }
                ];
                
                svg.selectAll('.link')
                    .data(links)
                    .enter().append('line')
                    .attr('class', 'neural-connection')
                    .attr('x1', d => nodes.find(n => n.id === d.source).x)
                    .attr('y1', d => nodes.find(n => n.id === d.source).y)
                    .attr('x2', d => nodes.find(n => n.id === d.target).x)
                    .attr('y2', d => nodes.find(n => n.id === d.target).y)
                    .style('stroke-width', d => d.strength * 5);
                
                svg.selectAll('.node')
                    .data(nodes)
                    .enter().append('circle')
                    .attr('class', 'brain-region interactive-element')
                    .attr('cx', d => d.x)
                    .attr('cy', d => d.y)
                    .attr('r', d => d.size)
                    .style('fill', (d, i) => d3.schemeCategory10[i]);
                
                svg.selectAll('.label')
                    .data(nodes)
                    .enter().append('text')
                    .attr('class', 'brain-region-label')
                    .attr('x', d => d.x)
                    .attr('y', d => d.y + 25)
                    .text(d => d.id);
            }
            
            handleTabChange(event) {
                event.preventDefault();
                
                const clickedTab = event.target.closest('.tab-btn');
                if (!clickedTab) return;
                
                const tabId = clickedTab.id.replace('tab-', '');
                
                document.querySelectorAll('.tab-btn').forEach(tab => {
                    tab.classList.remove('border-neural-500', 'text-neural-600', 'bg-neural-500/10', 'dark:bg-neural-500/20');
                    tab.classList.add('text-gray-500', 'dark:text-gray-400', 'border-transparent');
                });
                
                clickedTab.classList.remove('text-gray-500', 'dark:text-gray-400', 'border-transparent');
                clickedTab.classList.add('border-neural-500', 'text-neural-600', 'bg-neural-500/10', 'dark:bg-neural-500/20');
                
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                
                const targetContent = document.getElementById(`content-${tabId}`);
                if (targetContent) {
                    targetContent.classList.remove('hidden');
                    this.initializeTabSpecificContent(tabId);
                }
            }
            
            initializeTabSpecificContent(tabId) {
                switch (tabId) {
                    case 'behavioral':
                        this.createBehavioralCharts();
                        break;
                    case 'population':
                        this.createPopulationCharts();
                        break;
                    case 'single-unit':
                        this.createSingleUnitAnalysis();
                        break;
                    case 'brain-map':
                        this.updateBrainMapVisualization();
                        break;
                    case 'connectivity':
                        this.createConnectivityAnalysis();
                        break;
                    case 'results':
                        this.finalizeResultsDisplay();
                        break;
                }
            }
            
            createBehavioralCharts() {
                this.createLearningCurveChart();
                this.createReactionTimeChart();
            }
            
            createLearningCurveChart() {
                const ctx = document.getElementById('learningCurveChart');
                if (!ctx) return;
                
                const sessions = Array.from({length: 20}, (_, i) => i + 1);
                const performance = sessions.map(s => 
                    50 + 40 * (1 - Math.exp(-s/5)) + (Math.random() - 0.5) * 8
                );
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: sessions,
                        datasets: [{
                            label: 'Performance (%)',
                            data: performance,
                            borderColor: '#0ea5e9',
                            backgroundColor: 'rgba(14, 165, 233, 0.1)',
                            tension: 0.4,
                            fill: true,
                            borderWidth: 3,
                            pointRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Accuracy (%)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Session Number'
                                }
                            }
                        }
                    }
                });
            }
            
            createReactionTimeChart() {
                const ctx = document.getElementById('reactionTimeChart');
                if (!ctx) return;
                
                const bins = Array.from({length: 20}, (_, i) => (i * 50 + 200));
                const leftPrior = bins.map(() => Math.random() * 100 + 20);
                const rightPrior = bins.map(() => Math.random() * 100 + 20);
                
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: bins,
                        datasets: [{
                            label: 'Left Prior',
                            data: leftPrior,
                            backgroundColor: 'rgba(14, 165, 233, 0.6)',
                            borderColor: '#0ea5e9',
                            borderWidth: 1
                        }, {
                            label: 'Right Prior',
                            data: rightPrior,
                            backgroundColor: 'rgba(217, 70, 239, 0.6)',
                            borderColor: '#d946ef',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Trial Count'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Reaction Time (ms)'
                                }
                            }
                        }
                    }
                });
            }
            
            createPopulationCharts() {
                this.createTemporalComponentChart();
                this.createDistanceMatrix();
            }
            
            createTemporalComponentChart() {
                const ctx = document.getElementById('temporalComponentChart');
                if (!ctx) return;
                
                const timePoints = Array.from({length: 50}, (_, i) => i * 20);
                const pc1 = timePoints.map(t => 0.5 * Math.sin(t * 0.1) + Math.random() * 0.2);
                const pc2 = timePoints.map(t => 0.3 * Math.cos(t * 0.08) + Math.random() * 0.15);
                const pc3 = timePoints.map(t => 0.2 * Math.sin(t * 0.12) + Math.random() * 0.1);
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: timePoints,
                        datasets: [{
                            label: 'PC1 (47.3%)',
                            data: pc1,
                            borderColor: '#0ea5e9',
                            backgroundColor: 'rgba(14, 165, 233, 0.1)',
                            tension: 0.4,
                            borderWidth: 2
                        }, {
                            label: 'PC2 (26.8%)',
                            data: pc2,
                            borderColor: '#d946ef',
                            backgroundColor: 'rgba(217, 70, 239, 0.1)',
                            tension: 0.4,
                            borderWidth: 2
                        }, {
                            label: 'PC3 (15.2%)',
                            data: pc3,
                            borderColor: '#22c55e',
                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                            tension: 0.4,
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                title: {
                                    display: true,
                                    text: 'Component Weight'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time (ms)'
                                }
                            }
                        }
                    }
                });
            }
            
            createDistanceMatrix() {
                const container = document.getElementById('distance-matrix');
                if (!container) return;
                
                const regions = ['VISp', 'ACAd', 'MOp', 'SSp', 'CA1', 'LGd'];
                const size = regions.length;
                const cellSize = 40;
                
                const svg = d3.select(container)
                    .append('svg')
                    .attr('width', '100%')
                    .attr('height', '100%')
                    .attr('viewBox', `0 0 ${size * cellSize + 100} ${size * cellSize + 100}`);
                
                for (let i = 0; i < size; i++) {
                    for (let j = 0; j < size; j++) {
                        const distance = i === j ? 0 : Math.random();
                        const color = d3.interpolateBlues(distance);
                        
                        svg.append('rect')
                            .attr('x', j * cellSize + 50)
                            .attr('y', i * cellSize + 50)
                            .attr('width', cellSize - 1)
                            .attr('height', cellSize - 1)
                            .attr('fill', color)
                            .attr('class', 'interactive-element')
                            .on('mouseover', function(event) {
                                const tooltip = document.getElementById('tooltip');
                                tooltip.innerHTML = `${regions[i]} ↔ ${regions[j]}<br>Distance: ${distance.toFixed(3)}`;
                                tooltip.style.left = event.pageX + 10 + 'px';
                                tooltip.style.top = event.pageY - 10 + 'px';
                                tooltip.classList.add('show');
                            })
                            .on('mouseout', function() {
                                document.getElementById('tooltip').classList.remove('show');
                            });
                    }
                }
                
                regions.forEach((region, i) => {
                    svg.append('text')
                        .attr('x', 45)
                        .attr('y', i * cellSize + 50 + cellSize/2)
                        .attr('text-anchor', 'end')
                        .attr('alignment-baseline', 'middle')
                        .attr('font-size', '12px')
                        .attr('font-weight', 'bold')
                        .text(region);
                        
                    svg.append('text')
                        .attr('x', i * cellSize + 50 + cellSize/2)
                        .attr('y', 45)
                        .attr('text-anchor', 'middle')
                        .attr('alignment-baseline', 'middle')
                        .attr('font-size', '12px')
                        .attr('font-weight', 'bold')
                        .text(region);
                });
            }
            
            createSingleUnitAnalysis() {
                this.showNotification('Analyzing individual neuron responses...', 'info');
            }
            
            updateBrainMapVisualization() {
                this.showNotification('Updating brain atlas visualization...', 'info');
                generateActivityHeatmap();
            }
            
            createConnectivityAnalysis() {
                this.createConnectivityMatrix();
                this.createDegreeDistribution();
            }
            
            createConnectivityMatrix() {
                const ctx = document.getElementById('connectivityMatrix');
                if (!ctx) return;
                
                const matrix = [
                    [1.0, 0.73, 0.45, 0.32, 0.28, 0.51],
                    [0.73, 1.0, 0.61, 0.38, 0.52, 0.41],
                    [0.45, 0.61, 1.0, 0.84, 0.29, 0.33],
                    [0.32, 0.38, 0.84, 1.0, 0.25, 0.28],
                    [0.28, 0.52, 0.29, 0.25, 1.0, 0.37],
                    [0.51, 0.41, 0.33, 0.28, 0.37, 1.0]
                ];
                
                const canvas = ctx;
                const context = canvas.getContext('2d');
                const size = matrix.length;
                const cellSize = canvas.width / size;
                
                for (let i = 0; i < size; i++) {
                    for (let j = 0; j < size; j++) {
                        const value = matrix[i][j];
                        const intensity = Math.floor(value * 255);
                        context.fillStyle = `rgb(${255-intensity}, ${255-intensity}, 255)`;
                        context.fillRect(j * cellSize, i * cellSize, cellSize, cellSize);
                        
                        context.fillStyle = 'black';
                        context.font = '12px Arial';
                        context.textAlign = 'center';
                        context.fillText(
                            value.toFixed(2), 
                            j * cellSize + cellSize/2, 
                            i * cellSize + cellSize/2
                        );
                    }
                }
            }
            
            createDegreeDistribution() {
                const ctx = document.getElementById('degreeDistribution');
                if (!ctx) return;
                
                const degrees = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
                const counts = [2, 5, 8, 12, 15, 10, 7, 4, 2, 1];
                
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: degrees,
                        datasets: [{
                            label: 'Node Count',
                            data: counts,
                            backgroundColor: 'rgba(93, 92, 222, 0.6)',
                            borderColor: '#5D5CDE',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Number of Nodes'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Node Degree'
                                }
                            }
                        }
                    }
                });
            }
            
            finalizeResultsDisplay() {
                this.showNotification('Research findings compiled successfully!', 'success');
            }
            
            async refreshData() {
                this.showNotification('Refreshing neural data from IBL servers...', 'info');
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    
                    this.updateMetrics();
                    this.updateCharts();
                    this.showNotification('Data refresh complete! All metrics updated.', 'success');
                } catch (error) {
                    this.showNotification(`Refresh failed: ${error.message}`, 'error');
                }
            }
            
            updateCharts() {
                if (this.charts.neuralActivity) {
                    this.createAdvancedNeuralActivityChart();
                }
                if (this.charts.brainRegion) {
                    this.createEnhancedBrainRegionChart();
                }
            }
            
            async exportData() {
                this.showNotification('Preparing comprehensive data export...', 'info');
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    const exportData = {
                        timestamp: new Date().toISOString(),
                        researcher: this.researcherId,
                        summary: {
                            totalNeurons: 2847,
                            brainRegions: 18,
                            significantEffects: 674,
                            analysisComplete: true
                        },
                        behavioralMetrics: {
                            leftPriorBias: 72.8,
                            rightPriorBias: 69.4,
                            overallAccuracy: 86.7,
                            meanRT: 734
                        },
                        neuralFindings: {
                            priorEncodingNeurons: 521,
                            populationVarianceExplained: 89.3,
                            crossRegionalConnectivity: 0.68,
                            statisticalSignificance: '<0.001'
                        }
                    };
                    
                    const blob = new Blob([JSON.stringify(exportData, null, 2)], {
                        type: 'application/json'
                    });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `snazzy_inari_analysis_${Date.now()}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    this.showNotification('Data export successful! File downloaded.', 'success');
                } catch (error) {
                    this.showNotification(`Export failed: ${error.message}`, 'error');
                }
            }
            
            async runAdvancedAnalysis() {
                this.showNotification('Initiating advanced statistical analysis...', 'info');
                
                try {
                    const steps = [
                        'Preprocessing neural spike trains...',
                        'Computing cross-correlations...',
                        'Running PCA dimensionality reduction...',
                        'Statistical significance testing...',
                        'Generating population trajectories...',
                        'Finalizing results...'
                    ];
                    
                    for (let i = 0; i < steps.length; i++) {
                        this.showNotification(steps[i], 'info');
                        await new Promise(resolve => setTimeout(resolve, 1500));
                    }
                    
                    this.showNotification('Advanced analysis complete! Results updated in all tabs.', 'success');
                } catch (error) {
                    this.showNotification(`Analysis failed: ${error.message}`, 'error');
                }
            }
            
            toggleAnimation() {
                const button = document.getElementById('play-animation');
                
                if (this.isAnimating) {
                    this.isAnimating = false;
                    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>';
                    this.showNotification('Animation paused', 'info');
                } else {
                    this.isAnimating = true;
                    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>';
                    this.showNotification('Animation playing', 'info');
                    this.animateNeuralActivity();
                }
            }
            
            animateNeuralActivity() {
                if (!this.isAnimating) return;
                
                generateSpikeRaster();
                setTimeout(() => this.animateNeuralActivity(), 2000);
            }
            
            async runPCAAnalysis() {
                this.showNotification('Running PCA analysis on population data...', 'info');
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    this.showNotification('PCA analysis complete! Trajectory visualization updated.', 'success');
                } catch (error) {
                    this.showNotification(`PCA analysis failed: ${error.message}`, 'error');
                }
            }
            
            async analyzeSelectedUnits() {
                this.showNotification('Analyzing selected single units...', 'info');
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 2500));
                    this.showNotification('Single-unit analysis complete!', 'success');
                } catch (error) {
                    this.showNotification(`Unit analysis failed: ${error.message}`, 'error');
                }
            }
            
            async updateBrainMap() {
                this.showNotification('Updating brain atlas visualization...', 'info');
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    generateActivityHeatmap();
                    this.showNotification('Brain map updated successfully!', 'success');
                } catch (error) {
                    this.showNotification(`Map update failed: ${error.message}`, 'error');
                }
            }
            
            async computeConnectivity() {
                this.showNotification('Computing functional connectivity networks...', 'info');
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 3500));
                    this.createConnectivityAnalysis();
                    this.showNotification('Connectivity analysis complete!', 'success');
                } catch (error) {
                    this.showNotification(`Connectivity computation failed: ${error.message}`, 'error');
                }
            }
            
            showNotification(message, type = 'info', duration = 4000) {
                const container = document.getElementById('notification-container');
                if (!container) return;
                
                const notification = document.createElement('div');
                notification.className = `flex items-center p-4 rounded-xl shadow-lg transform translate-x-full transition-all duration-500 mb-3`;
                
                let bgColor, iconColor, icon;
                switch (type) {
                    case 'success':
                        bgColor = 'bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-700';
                        iconColor = 'text-green-600';
                        icon = '✓';
                        break;
                    case 'error':
                        bgColor = 'bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-700';
                        iconColor = 'text-red-600';
                        icon = '✕';
                        break;
                    case 'warning':
                        bgColor = 'bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700';
                        iconColor = 'text-yellow-600';
                        icon = '⚠';
                        break;
                    default:
                        bgColor = 'bg-blue-100 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700';
                        iconColor = 'text-blue-600';
                        icon = 'ℹ';
                }
                
                notification.className += ' ' + bgColor;
                notification.innerHTML = `
                    <div class="flex items-center space-x-3 flex-1">
                        <div class="w-8 h-8 rounded-full bg-white dark:bg-gray-800 flex items-center justify-center ${iconColor} font-bold">
                            ${icon}
                        </div>
                        <p class="text-sm font-medium text-gray-800 dark:text-gray-200">${message}</p>
                    </div>
                    <button class="ml-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200" onclick="this.parentElement.remove()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                `;
                
                container.appendChild(notification);
                
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 100);
                
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 500);
                }, duration);
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const snazzyInari = new AdvancedSnazzyInariSystem();
            
            const resizeObserver = new ResizeObserver(entries => {
                Object.values(snazzyInari.charts).forEach(chart => {
                    if (chart && chart.resize) {
                        chart.resize();
                    }
                });
            });
            
            document.querySelectorAll('.chart-container, .large-chart-container').forEach(container => {
                resizeObserver.observe(container);
            });
            
            window.addEventListener('beforeunload', function() {
                Object.values(snazzyInari.charts).forEach(chart => {
                    if (chart && chart.destroy) {
                        chart.destroy();
                    }
                });
            });
        });
    </script>
</body>
</html>